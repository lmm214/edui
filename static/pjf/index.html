<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>分橘子</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #E6F3FF, #F0FFF0);
            height: 100vh;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .game-container {
        }

        #gameCanvas {
            display: block;
            cursor: grab;
            background: linear-gradient(135deg, #E6F3FF, #F0FFF0);
        }

        #gameCanvas:active {
            cursor: grabbing;
        }

        #gameCanvas.select-mode {
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="%23333" d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/></svg>') 12 12, crosshair;
        }

        #gameCanvas.select-mode:active {
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="%23333" d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/></svg>') 12 12, crosshair;
        }

        /* 圈选完成后的拖拽状态 */
        #gameCanvas.select-mode.dragging-selection {
            cursor: pointer !important;
        }

        .title {
            position: absolute;
            top: -50px;
            left: 50%;
            transform: translateX(-50%);
            color: #333;
            font-size: 24px;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(255,255,255,0.8);
            white-space: nowrap;
        }

        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #333;
            font-size: 18px;
        }

        .controls {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
        }

        .mode-button {
            padding: 6px 12px;
            border: none;
            border-radius: 12px;
            background: #4CAF50;
            color: white;
            font-size: 28px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .mode-button:hover {
            background: #45a049;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }

        .mode-button.active {
            background: #FF6B35;
        }

        .mode-button.active:hover {
            background: #e55a2b;
        }

        .auto-distribute-buttons {
            position: absolute;
            bottom: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
        }

        .auto-button {
            width: 50px;
            height: 50px;
            border: none;
            border-radius: 50%;
            background: #2196F3;
            color: white;
            font-size: 20px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .auto-button:hover {
            background: #1976D2;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }

        .auto-button:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .auto-button.active {
            background: #FF6B35;
        }

        .auto-button.active:hover {
            background: #e55a2b;
        }

        .instruction {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            color: #fff;
            font-size: 28px;
            text-align: center;
            background: rgba(0,0,0,0.4);
            padding: 6px 12px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            border: 1px solid rgba(255,255,255,0.3);
            line-height: 1.4;
        }

        @media (max-width: 768px) {
            .title {
                font-size: 20px;
                top: -40px;
            }
            
            .controls {
                top: 5px;
                right: 5px;
            }
            
            .mode-button {
                padding: 6px 12px;
                font-size: 12px;
            }
            
            .instruction {
                font-size: 16px;
                padding: 10px 20px;
                max-width: 90%;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="controls">
            <button id="toggleMode" class="mode-button">圈分</button>
            <button id="resetBtn" class="mode-button" style="display: none;">重分</button>
        </div>
        <div class="auto-distribute-buttons">
            <button id="autoBtn1" class="auto-button">1</button>
            <button id="autoBtn2" class="auto-button">2</button>
            <button id="autoBtn3" class="auto-button">3</button>
        </div>
        <canvas id="gameCanvas" width="1000" height="600"></canvas>
        <div class="loading" id="loading">加载中...</div>
        <div class="instruction" id="instruction">拖动橘子放到盘子里</div>
    </div>

    <script>
const _0x1d5c=['dragging-selection','arc','select-mode','createPlaceholderImage','distributionCount','autoDistributeToPlates','exitSelectModeAndShowReset','resetBtn','none','originalPositions','isPointInOrange','getPlateAt','performAutoDistribute','checkAllOrangesDistributed','updateAutoButtonStates','getElementById','sort','orangeSize','style','floor','toggleModeBtn','gameLoop','brightness(1.2)','handleTouchEnd','canvas','plates','textAlign','click','targetScale','最后每份再各放1个，正好分完。','toggleMode','autoBtn2','#FFD700','loading','mousemove','remove','每份先各放1个，分掉6个。','set','calculateOrangePosition','autoDistributeMode','#E0E0E0','isPointInPolygon','preventDefault','indexOf','textContent','highlight','random','mousedown','display','autoDistributeCount','identifier','addEventListener','cos','#FF6B35','fillText','ghostOranges','handleMove','isDragging','imageSmoothingQuality','startAutoDistribute','imageSmoothingEnabled','isPointInPlate','add','exitSelectMode','min','now','render','isSelectMode','orange','activeTouches','block','oranges','已选择:\x20','images','init','getSelectionCenter','分配完成！','map','plateY','selectionPath','自动分配中：每次','offset','#4CAF50','autoDistributeIndex','setupCanvas','selectionDragOffset','left','length','updateSelectionFromPath','fill','fillStyle','closePath','onPlate','save','restore','createOrangesWithoutOverlap','isDraggingSelection','clientY','scale','dragOrange','handleTouchMove','instruction','handleStart','all','gameCanvas','pop','round','plate','getCanvasCoordinates','filter','width','pow','个橘子','dragOffset','ctx','plateId','touchmove','画线围住6个橘子，然后拖动会自动分配。','classList','splice','addEventListeners','stroke','plateHeight','totalImages','arrangeOrangesOnPlate','height','animateOrangeToPlate','fillRect','changedTouches','loadImages','autoBtn1','isSelecting','panzi.png','includes','clearSelection','juzi.png','updateAnimations','slice','drawImage','拖动橘子放到盘子里','个放入盘子','imagesLoaded','createGameObjects','startGame','个分配中...\x20剩余','isPointInSelectionPath','sqrt','resetGame','getContext','max','strokeStyle','delete','sin','handleEnd','autoBtn3','getBoundingClientRect','handleTouchStart','active','some','selectedOranges','translate','high','forEach','push','plateWidth','ceil'];const _0x2971=function(_0x1d5c62,_0x297184){_0x1d5c62=_0x1d5c62-0x0;let _0x81be16=_0x1d5c[_0x1d5c62];return _0x81be16;};class CanvasDragGame{constructor(){this[_0x2971('0x18')]=document['getElementById'](_0x2971('0x68'));this['ctx']=this[_0x2971('0x18')][_0x2971('0x94')]('2d');this[_0x2971('0x21')]=document[_0x2971('0xf')]('loading');this['instruction']=document[_0x2971('0xf')](_0x2971('0x65'));this[_0x2971('0x14')]=document['getElementById'](_0x2971('0x1e'));this['resetBtn']=document['getElementById'](_0x2971('0x7'));this[_0x2971('0x82')]=document['getElementById']('autoBtn1');this[_0x2971('0x1f')]=document['getElementById']('autoBtn2');this['autoBtn3']=document['getElementById'](_0x2971('0x9a'));this['oranges']=[];this[_0x2971('0x19')]=[];this['images']={};this[_0x2971('0x8d')]=0x0;this[_0x2971('0x7b')]=0x2;this[_0x2971('0x39')]=![];this[_0x2971('0x63')]=null;this['dragOffset']={'x':0x0,'y':0x0};this['hoveredPlate']=null;this['activeTouches']=new Map();this['isSelectMode']=![];this['isSelecting']=![];this[_0x2971('0x4f')]=[];this[_0x2971('0x9f')]=[];this[_0x2971('0x60')]=![];this[_0x2971('0x55')]={'x':0x0,'y':0x0};this['ghostOranges']=[];this['distributionCount']=0x0;this['orangeSize']=0x3c;this['plateWidth']=0x78;this[_0x2971('0x7a')]=0x3a;this[_0x2971('0x4e')]=this['canvas']['height']-0xa0;this['autoDistributeMode']=0x0;this['autoDistributeIndex']=0x0;this[_0x2971('0x31')]=0x0;this[_0x2971('0x4a')]();}[_0x2971('0x4a')](){this[_0x2971('0x54')]();this['loadImages']();}['setupCanvas'](){const _0x59028a=this[_0x2971('0x18')]['getBoundingClientRect']();this[_0x2971('0x18')]['width']=_0x59028a[_0x2971('0x6e')];this[_0x2971('0x18')][_0x2971('0x7d')]=_0x59028a['height'];this['plateY']=this[_0x2971('0x18')][_0x2971('0x7d')]-0xa0;}[_0x2971('0x81')](){const _0x2417a9={'orange':_0x2971('0x87'),'plate':_0x2971('0x84')};Object['keys'](_0x2417a9)['forEach'](_0x237ede=>{const _0x45f933=new Image();_0x45f933['onload']=()=>{this[_0x2971('0x49')][_0x237ede]=_0x45f933;this[_0x2971('0x8d')]++;if(this['imagesLoaded']===this['totalImages']){this['startGame']();}};_0x45f933['onerror']=()=>{this[_0x2971('0x49')][_0x237ede]=this['createPlaceholderImage'](_0x237ede);this['imagesLoaded']++;if(this['imagesLoaded']===this[_0x2971('0x7b')]){this[_0x2971('0x8f')]();}};_0x45f933['src']=_0x2417a9[_0x237ede];});}[_0x2971('0x3')](_0x4e592d){const _0x206b6d=document['createElement'](_0x2971('0x18'));const _0x56e6ad=_0x206b6d['getContext']('2d');if(_0x4e592d===_0x2971('0x44')){_0x206b6d['width']=_0x206b6d[_0x2971('0x7d')]=0x3c;_0x56e6ad[_0x2971('0x5a')]=_0x2971('0x35');_0x56e6ad['beginPath']();_0x56e6ad[_0x2971('0x1')](0x1e,0x1e,0x19,0x0,Math['PI']*0x2);_0x56e6ad[_0x2971('0x59')]();_0x56e6ad['fillStyle']='#228B22';_0x56e6ad[_0x2971('0x7f')](0x19,0x5,0xa,0xf);}else if(_0x4e592d==='plate'){_0x206b6d[_0x2971('0x6e')]=0x78;_0x206b6d['height']=0x3a;_0x56e6ad[_0x2971('0x5a')]=_0x2971('0x28');_0x56e6ad['beginPath']();_0x56e6ad['ellipse'](0x3c,0x28,0x37,0x23,0x0,0x0,Math['PI']*0x2);_0x56e6ad['fill']();}return _0x206b6d;}[_0x2971('0x8f')](){this[_0x2971('0x21')]['style']['display']='none';this[_0x2971('0x8e')]();this[_0x2971('0x78')]();this['addModeListeners']();this[_0x2971('0x15')]();}['createGameObjects'](){this[_0x2971('0x5f')]();const _0x529ace=(this[_0x2971('0x18')]['width']-0x6*this[_0x2971('0xa4')])/0x7;for(let _0x585203=0x0;_0x585203<0x6;_0x585203++){this['plates']['push']({'id':_0x585203,'x':_0x529ace+_0x585203*(this[_0x2971('0xa4')]+_0x529ace),'y':this[_0x2971('0x4e')],'width':this[_0x2971('0xa4')],'height':this['plateHeight'],'oranges':[],'highlight':![],'scale':0x1,'targetScale':0x1});}}[_0x2971('0x6')](){this['isSelectMode']=![];this[_0x2971('0x18')]['classList'][_0x2971('0x23')](_0x2971('0x2'));this[_0x2971('0x86')]();this['toggleModeBtn']['style']['display']=_0x2971('0x8');this['resetBtn'][_0x2971('0x12')][_0x2971('0x30')]='inline-block';}[_0x2971('0x93')](){this['distributionCount']=0x0;this[_0x2971('0x43')]=![];this['canvas'][_0x2971('0x76')]['remove']('select-mode');this[_0x2971('0x86')]();this[_0x2971('0x27')]=0x0;this[_0x2971('0x53')]=0x0;this['autoDistributeCount']=0x0;this[_0x2971('0xe')]();this['plates'][_0x2971('0xa2')](_0x33a0de=>{_0x33a0de['oranges']=[];_0x33a0de[_0x2971('0x2d')]=![];_0x33a0de['targetScale']=0x1;});this['oranges']=[];this[_0x2971('0x5f')]();this['toggleModeBtn'][_0x2971('0x12')][_0x2971('0x30')]='inline-block';this['toggleModeBtn'][_0x2971('0x2c')]='圈分';this[_0x2971('0x14')][_0x2971('0x76')]['remove'](_0x2971('0x9d'));this[_0x2971('0x7')]['style']['display']='none';this[_0x2971('0x65')]['textContent']='拖动橘子放到盘子里';}['createOrangesWithoutOverlap'](){const _0x2edfd2=0x3e8;const _0x9a9793=this[_0x2971('0x11')];const _0x40a30a=this['canvas'][_0x2971('0x7d')]-0xc8;const _0xef01c5=0xa;const _0x4cbf65=this[_0x2971('0x18')]['width']*0.6;const _0xe831db=_0x40a30a*0.6;const _0x30da01=(this['canvas'][_0x2971('0x6e')]-_0x4cbf65)/0x2;const _0x9001c1=(_0x40a30a-_0xe831db)/0x2;for(let _0x37ffea=0x0;_0x37ffea<0x12;_0x37ffea++){let _0x4b8b78=0x0;let _0x345786=![];let _0x396ee9;while(!_0x345786&&_0x4b8b78<_0x2edfd2){const _0x4d755c=_0x30da01+_0x4cbf65-this[_0x2971('0x11')];const _0x3b126a=_0x9001c1+_0xe831db-this[_0x2971('0x11')];const _0x460eef=Math[_0x2971('0x2e')]()*(_0x4d755c-_0x30da01)+_0x30da01;const _0x24aa4f=Math[_0x2971('0x2e')]()*(_0x3b126a-_0x9001c1)+_0x9001c1;_0x396ee9={'id':_0x37ffea,'x':_0x460eef,'y':_0x24aa4f,'width':this['orangeSize'],'height':this[_0x2971('0x11')],'onPlate':![],'plateId':null,'scale':0x1,'targetScale':0x1};_0x345786=!![];for(let _0x55b6cf=0x0;_0x55b6cf<this['oranges'][_0x2971('0x57')];_0x55b6cf++){const _0x1589df=this['oranges'][_0x55b6cf];const _0x3f3fe5=Math['sqrt'](Math[_0x2971('0x6f')](_0x396ee9['x']+_0x396ee9['width']/0x2-_0x1589df['x']-_0x1589df['width']/0x2,0x2)+Math[_0x2971('0x6f')](_0x396ee9['y']+_0x396ee9[_0x2971('0x7d')]/0x2-_0x1589df['y']-_0x1589df['height']/0x2,0x2));if(_0x3f3fe5<_0x9a9793){_0x345786=![];break;}}_0x4b8b78++;}if(!_0x345786){const _0x2dacbd=Math[_0x2971('0xa5')](Math[_0x2971('0x92')](0x12));const _0x38b54b=Math['ceil'](0x12/_0x2dacbd);const _0x217410=_0x4cbf65/_0x2dacbd;const _0x598512=_0xe831db/_0x38b54b;const _0xdd611b=_0x37ffea%_0x2dacbd;const _0x37a034=Math[_0x2971('0x13')](_0x37ffea/_0x2dacbd);_0x396ee9={'id':_0x37ffea,'x':_0x30da01+_0xdd611b*_0x217410+(_0x217410-this['orangeSize'])/0x2,'y':_0x9001c1+_0x37a034*_0x598512+(_0x598512-this[_0x2971('0x11')])/0x2,'width':this['orangeSize'],'height':this['orangeSize'],'onPlate':![],'plateId':null,'scale':0x1,'targetScale':0x1};_0x396ee9['x']=Math['max'](_0x30da01,Math[_0x2971('0x40')](_0x396ee9['x'],_0x30da01+_0x4cbf65-this[_0x2971('0x11')]));_0x396ee9['y']=Math['max'](_0x9001c1,Math[_0x2971('0x40')](_0x396ee9['y'],_0x9001c1+_0xe831db-this[_0x2971('0x11')]));}this['oranges']['push'](_0x396ee9);}}[_0x2971('0x78')](){this['canvas']['addEventListener'](_0x2971('0x2f'),_0x5cac2e=>this[_0x2971('0x66')](_0x5cac2e));this['canvas']['addEventListener'](_0x2971('0x22'),_0x4f78c1=>this[_0x2971('0x38')](_0x4f78c1));this['canvas'][_0x2971('0x33')]('mouseup',_0x54e637=>this['handleEnd'](_0x54e637));this[_0x2971('0x18')][_0x2971('0x33')]('touchstart',_0x444da8=>{_0x444da8[_0x2971('0x2a')]();for(let _0x273952=0x0;_0x273952<_0x444da8[_0x2971('0x80')][_0x2971('0x57')];_0x273952++){this[_0x2971('0x9c')](_0x444da8['changedTouches'][_0x273952]);}});this['canvas']['addEventListener'](_0x2971('0x74'),_0x2b0285=>{_0x2b0285[_0x2971('0x2a')]();for(let _0x29da24=0x0;_0x29da24<_0x2b0285['changedTouches']['length'];_0x29da24++){this[_0x2971('0x64')](_0x2b0285['changedTouches'][_0x29da24]);}});this['canvas'][_0x2971('0x33')]('touchend',_0x815b04=>{_0x815b04[_0x2971('0x2a')]();for(let _0x4b12d4=0x0;_0x4b12d4<_0x815b04['changedTouches']['length'];_0x4b12d4++){this['handleTouchEnd'](_0x815b04['changedTouches'][_0x4b12d4]);}});this['canvas']['addEventListener']('contextmenu',_0x34a4f4=>_0x34a4f4[_0x2971('0x2a')]());}['addModeListeners'](){this['toggleModeBtn'][_0x2971('0x33')](_0x2971('0x1b'),()=>{this['toggleMode']();});this[_0x2971('0x7')][_0x2971('0x33')]('click',()=>{this['resetGame']();});this[_0x2971('0x82')][_0x2971('0x33')](_0x2971('0x1b'),()=>{this[_0x2971('0x3b')](0x1);});this[_0x2971('0x1f')][_0x2971('0x33')]('click',()=>{this[_0x2971('0x3b')](0x2);});this[_0x2971('0x9a')][_0x2971('0x33')]('click',()=>{this[_0x2971('0x3b')](0x3);});}['toggleMode'](){if(this['isSelectMode']){this[_0x2971('0x43')]=![];this['toggleModeBtn']['textContent']='圈分';this['toggleModeBtn']['classList'][_0x2971('0x23')]('active');this[_0x2971('0x18')][_0x2971('0x76')][_0x2971('0x23')]('select-mode');this['instruction']['textContent']=_0x2971('0x8b');this[_0x2971('0x86')]();}else{this['isSelectMode']=!![];this[_0x2971('0x14')]['textContent']='退出';this[_0x2971('0x14')]['classList'][_0x2971('0x3e')](_0x2971('0x9d'));this['canvas']['classList']['add']('select-mode');this[_0x2971('0x65')][_0x2971('0x2c')]=_0x2971('0x75');this['clearSelection']();}}[_0x2971('0x86')](){this[_0x2971('0x9f')]=[];this['selectionPath']=[];this['isSelecting']=![];this['isDraggingSelection']=![];this[_0x2971('0x37')]=[];this['originalPositions']=null;this['canvas'][_0x2971('0x76')]['remove'](_0x2971('0x0'));}['getCanvasCoordinates'](_0x211b46){const _0x677e50=this['canvas'][_0x2971('0x9b')]();return{'x':_0x211b46['clientX']-_0x677e50[_0x2971('0x56')],'y':_0x211b46[_0x2971('0x61')]-_0x677e50['top']};}[_0x2971('0x66')](_0x5b79f6){const _0x53bcca=this[_0x2971('0x6c')](_0x5b79f6);if(this[_0x2971('0x43')]){if(this[_0x2971('0x9f')]['length']===0x6&&this[_0x2971('0x91')](_0x53bcca)){this[_0x2971('0x60')]=!![];const _0x366c3e=this['getSelectionCenter']();this[_0x2971('0x55')]['x']=_0x53bcca['x']-_0x366c3e['x'];this['selectionDragOffset']['y']=_0x53bcca['y']-_0x366c3e['y'];if(this['originalPositions']){this[_0x2971('0x37')]=this[_0x2971('0x9')][_0x2971('0x4d')](_0x18fbc1=>({'x':_0x18fbc1['x'],'y':_0x18fbc1['y'],'width':_0x18fbc1['width'],'height':_0x18fbc1[_0x2971('0x7d')]}));}}else if(this[_0x2971('0x9f')]['length']===0x6){this['clearSelection']();this['isSelecting']=!![];this[_0x2971('0x4f')]=[{'x':_0x53bcca['x'],'y':_0x53bcca['y']}];this[_0x2971('0x9f')]=[];}else{this['isSelecting']=!![];this['selectionPath']=[{'x':_0x53bcca['x'],'y':_0x53bcca['y']}];this[_0x2971('0x9f')]=[];}}else{for(let _0x57b360=this['oranges']['length']-0x1;_0x57b360>=0x0;_0x57b360--){const _0x20df31=this[_0x2971('0x47')][_0x57b360];if(this[_0x2971('0xa')](_0x53bcca,_0x20df31)){this['isDragging']=!![];this[_0x2971('0x63')]=_0x20df31;this[_0x2971('0x71')]['x']=_0x53bcca['x']-_0x20df31['x'];this[_0x2971('0x71')]['y']=_0x53bcca['y']-_0x20df31['y'];_0x20df31['targetScale']=1.1;if(_0x20df31['onPlate']&&_0x20df31[_0x2971('0x73')]!==null){const _0xba5bfe=this[_0x2971('0x19')][_0x20df31[_0x2971('0x73')]];const _0x3a64ff=_0xba5bfe[_0x2971('0x47')]['indexOf'](_0x20df31);if(_0x3a64ff>-0x1){_0xba5bfe[_0x2971('0x47')][_0x2971('0x77')](_0x3a64ff,0x1);this[_0x2971('0x7c')](_0xba5bfe);}_0x20df31[_0x2971('0x5c')]=![];_0x20df31['plateId']=null;}break;}}}}[_0x2971('0x38')](_0x38f547){const _0x536b9f=this['getCanvasCoordinates'](_0x38f547);if(this['isSelectMode']){if(this['isSelecting']){const _0x26a301=this['selectionPath'][this['selectionPath']['length']-0x1];const _0x360333=Math[_0x2971('0x92')](Math['pow'](_0x536b9f['x']-_0x26a301['x'],0x2)+Math['pow'](_0x536b9f['y']-_0x26a301['y'],0x2));if(_0x360333>0x3){this['selectionPath'][_0x2971('0xa3')]({'x':_0x536b9f['x'],'y':_0x536b9f['y']});this['updateSelectionFromPath']();}}else if(this[_0x2971('0x60')]&&this[_0x2971('0x9f')]['length']===0x6){const _0x581c41=this['getSelectionCenter']();const _0x1841fd=_0x536b9f['x']-this['selectionDragOffset']['x'];const _0x20bf5e=_0x536b9f['y']-this[_0x2971('0x55')]['y'];const _0x1a300f=_0x1841fd-_0x581c41['x'];const _0x355bca=_0x20bf5e-_0x581c41['y'];this['selectedOranges']['forEach'](_0x454e39=>{_0x454e39['x']+=_0x1a300f;_0x454e39['y']+=_0x355bca;});}}else{if(!this['isDragging']||!this[_0x2971('0x63')])return;const _0x57ca85=0x5;let _0xbf1253=_0x536b9f['x']-this['dragOffset']['x'];let _0x1614b6=_0x536b9f['y']-this[_0x2971('0x71')]['y'];_0xbf1253=Math['max'](_0x57ca85,Math[_0x2971('0x40')](_0xbf1253,this['canvas']['width']-this['dragOrange']['width']-_0x57ca85));_0x1614b6=Math[_0x2971('0x95')](_0x57ca85,Math[_0x2971('0x40')](_0x1614b6,this['canvas']['height']-this[_0x2971('0x63')]['height']-_0x57ca85));this[_0x2971('0x63')]['x']=_0xbf1253;this['dragOrange']['y']=_0x1614b6;this['hoveredPlate']=null;this['plates']['forEach'](_0x545a05=>{_0x545a05['highlight']=![];_0x545a05['targetScale']=0x1;if(this[_0x2971('0x3d')](_0x536b9f,_0x545a05)){this['hoveredPlate']=_0x545a05;_0x545a05[_0x2971('0x2d')]=!![];_0x545a05[_0x2971('0x1c')]=1.05;}});}}['handleEnd'](_0x5f8da){const _0x2c4dfb=this['getCanvasCoordinates'](_0x5f8da);if(this['isSelectMode']){if(this['isSelecting']){this['isSelecting']=![];if(this[_0x2971('0x4f')][_0x2971('0x57')]>0x2){this['selectionPath'][_0x2971('0xa3')](this['selectionPath'][0x0]);this[_0x2971('0x58')]();this['finalizeSelection']();}}else if(this['isDraggingSelection']){this['isDraggingSelection']=![];if(this[_0x2971('0x9f')]['length']===0x6){this['autoDistributeToPlates']();}}}else{if(!this[_0x2971('0x39')]||!this['dragOrange'])return;const _0x2379fd=this[_0x2971('0xb')](_0x2c4dfb);if(_0x2379fd){this['placeOrangeOnPlate'](this['dragOrange'],_0x2379fd);}this[_0x2971('0x63')]['targetScale']=0x1;this[_0x2971('0x19')][_0x2971('0xa2')](_0x4bae24=>{_0x4bae24[_0x2971('0x2d')]=![];_0x4bae24['targetScale']=0x1;});this[_0x2971('0x39')]=![];this['dragOrange']=null;this['hoveredPlate']=null;}}[_0x2971('0x9c')](_0xae9a79){const _0x43e7c5=this['getCanvasCoordinates'](_0xae9a79);if(this[_0x2971('0x43')]){this[_0x2971('0x66')](_0xae9a79);return;}for(let _0x44a465=this[_0x2971('0x47')]['length']-0x1;_0x44a465>=0x0;_0x44a465--){const _0x5a699c=this['oranges'][_0x44a465];if(this['isPointInOrange'](_0x43e7c5,_0x5a699c)&&!_0x5a699c['onPlate']){let _0x3499a0=![];for(let [_0x472453,_0x26ee9c]of this['activeTouches']){if(_0x26ee9c[_0x2971('0x44')]===_0x5a699c){_0x3499a0=!![];break;}}if(!_0x3499a0){this['activeTouches'][_0x2971('0x25')](_0xae9a79['identifier'],{'orange':_0x5a699c,'offset':{'x':_0x43e7c5['x']-_0x5a699c['x'],'y':_0x43e7c5['y']-_0x5a699c['y']}});_0x5a699c[_0x2971('0x1c')]=1.1;if(_0x5a699c[_0x2971('0x5c')]&&_0x5a699c['plateId']!==null){const _0x1210a5=this[_0x2971('0x19')][_0x5a699c[_0x2971('0x73')]];const _0x371146=_0x1210a5['oranges'][_0x2971('0x2b')](_0x5a699c);if(_0x371146>-0x1){_0x1210a5['oranges'][_0x2971('0x77')](_0x371146,0x1);this[_0x2971('0x7c')](_0x1210a5);}_0x5a699c['onPlate']=![];_0x5a699c['plateId']=null;}break;}}}}[_0x2971('0x64')](_0x419ece){const _0x540ea9=this[_0x2971('0x6c')](_0x419ece);if(this[_0x2971('0x43')]){this['handleMove'](_0x419ece);return;}const _0x3b69b8=this['activeTouches']['get'](_0x419ece[_0x2971('0x32')]);if(_0x3b69b8){const _0x140a28=_0x3b69b8['orange'];_0x140a28['x']=_0x540ea9['x']-_0x3b69b8[_0x2971('0x51')]['x'];_0x140a28['y']=_0x540ea9['y']-_0x3b69b8[_0x2971('0x51')]['y'];this['plates'][_0x2971('0xa2')](_0x4f6148=>{_0x4f6148['highlight']=![];_0x4f6148['targetScale']=0x1;});const _0x118273=this[_0x2971('0xb')](_0x540ea9);if(_0x118273){_0x118273[_0x2971('0x2d')]=!![];_0x118273['targetScale']=1.1;}}}[_0x2971('0x17')](_0x38afd1){const _0x36e85f=this['getCanvasCoordinates'](_0x38afd1);if(this[_0x2971('0x43')]){this[_0x2971('0x99')](_0x38afd1);return;}const _0x55ef68=this['activeTouches']['get'](_0x38afd1['identifier']);if(_0x55ef68){const _0x5b60cd=_0x55ef68[_0x2971('0x44')];const _0x5d3164=this[_0x2971('0xb')](_0x36e85f);if(_0x5d3164){this['placeOrangeOnPlate'](_0x5b60cd,_0x5d3164);}_0x5b60cd[_0x2971('0x1c')]=0x1;this[_0x2971('0x45')][_0x2971('0x97')](_0x38afd1['identifier']);}this['plates'][_0x2971('0xa2')](_0x298272=>{_0x298272['highlight']=![];_0x298272['targetScale']=0x1;});}['isPointInOrange'](_0x55cd78,_0x258606){return _0x55cd78['x']>=_0x258606['x']&&_0x55cd78['x']<=_0x258606['x']+_0x258606[_0x2971('0x6e')]&&_0x55cd78['y']>=_0x258606['y']&&_0x55cd78['y']<=_0x258606['y']+_0x258606['height'];}['isPointInPlate'](_0x368474,_0xb92540){const _0x9b80be=0x28;return _0x368474['x']>=_0xb92540['x']&&_0x368474['x']<=_0xb92540['x']+_0xb92540[_0x2971('0x6e')]&&_0x368474['y']>=_0xb92540['y']-_0x9b80be&&_0x368474['y']<=_0xb92540['y']+_0xb92540['height'];}[_0x2971('0xb')](_0x24df00){for(let _0x481ec2 of this['plates']){if(this[_0x2971('0x3d')](_0x24df00,_0x481ec2)){return _0x481ec2;}}return null;}['isPointInSelectionPath'](_0x3e3130){if(this[_0x2971('0x4f')][_0x2971('0x57')]<0x3||this[_0x2971('0x9f')][_0x2971('0x57')]!==0x6)return![];return this[_0x2971('0x29')](_0x3e3130,this[_0x2971('0x4f')]);}['updateSelectionFromPath'](){if(this[_0x2971('0x4f')][_0x2971('0x57')]<0x3){this[_0x2971('0x9f')]=[];return;}this[_0x2971('0x9f')]=[];this['oranges'][_0x2971('0xa2')](_0x42ed38=>{if(!_0x42ed38[_0x2971('0x5c')]&&this['isOrangeInSelectionPath'](_0x42ed38)){this[_0x2971('0x9f')][_0x2971('0xa3')](_0x42ed38);}});}['isOrangeInSelectionPath'](_0x439acb){if(this[_0x2971('0x4f')][_0x2971('0x57')]<0x3)return![];const _0x45fb8f=_0x439acb['x']+_0x439acb[_0x2971('0x6e')]/0x2;const _0x5a8e5c=_0x439acb['y']+_0x439acb[_0x2971('0x7d')]/0x2;const _0x43e9e9=_0x439acb['width']/0x3;const _0x19d091=[{'x':_0x45fb8f,'y':_0x5a8e5c},{'x':_0x45fb8f-_0x43e9e9,'y':_0x5a8e5c},{'x':_0x45fb8f+_0x43e9e9,'y':_0x5a8e5c},{'x':_0x45fb8f,'y':_0x5a8e5c-_0x43e9e9},{'x':_0x45fb8f,'y':_0x5a8e5c+_0x43e9e9}];return _0x19d091[_0x2971('0x9e')](_0x1b9b0d=>this[_0x2971('0x29')](_0x1b9b0d,this['selectionPath']));}[_0x2971('0x29')](_0x35858f,_0x1bbe79){if(_0x1bbe79[_0x2971('0x57')]<0x3)return![];let _0x4d7fb3=![];for(let _0x3809bb=0x0,_0x1cb0c9=_0x1bbe79[_0x2971('0x57')]-0x1;_0x3809bb<_0x1bbe79[_0x2971('0x57')];_0x1cb0c9=_0x3809bb++){const _0x16fb23=_0x1bbe79[_0x3809bb]['x'],_0x2b246d=_0x1bbe79[_0x3809bb]['y'];const _0x10ef7c=_0x1bbe79[_0x1cb0c9]['x'],_0x460992=_0x1bbe79[_0x1cb0c9]['y'];if(_0x2b246d>_0x35858f['y']!==_0x460992>_0x35858f['y']&&_0x35858f['x']<(_0x10ef7c-_0x16fb23)*(_0x35858f['y']-_0x2b246d)/(_0x460992-_0x2b246d)+_0x16fb23){_0x4d7fb3=!_0x4d7fb3;}}return _0x4d7fb3;}[_0x2971('0x4b')](){if(this['selectedOranges'][_0x2971('0x57')]===0x0)return{'x':0x0,'y':0x0};let _0x58a64f=0x0,_0x226063=0x0;this[_0x2971('0x9f')]['forEach'](_0x4d1b95=>{_0x58a64f+=_0x4d1b95['x']+_0x4d1b95[_0x2971('0x6e')]/0x2;_0x226063+=_0x4d1b95['y']+_0x4d1b95[_0x2971('0x7d')]/0x2;});return{'x':_0x58a64f/this['selectedOranges'][_0x2971('0x57')],'y':_0x226063/this['selectedOranges'][_0x2971('0x57')]};}['finalizeSelection'](){if(this[_0x2971('0x9f')]['length']===0x6){this[_0x2971('0x9')]=this['selectedOranges'][_0x2971('0x4d')](_0x347b3b=>({'x':_0x347b3b['x'],'y':_0x347b3b['y'],'width':_0x347b3b['width'],'height':_0x347b3b['height']}));this[_0x2971('0x18')]['classList']['add'](_0x2971('0x0'));this[_0x2971('0x65')][_0x2971('0x2c')]='拖动选区自动分配到6个盘子';}else{this[_0x2971('0x86')]();this['instruction'][_0x2971('0x2c')]='请圈选6个橘子';}}[_0x2971('0x5')](){if(this[_0x2971('0x9f')][_0x2971('0x57')]!==0x6)return;if(this['ghostOranges']['length']===0x0){this['ghostOranges']=this['originalPositions']?this[_0x2971('0x9')]['slice']():this['selectedOranges']['map'](_0x4ab37b=>({'x':_0x4ab37b['x'],'y':_0x4ab37b['y'],'width':_0x4ab37b['width'],'height':_0x4ab37b[_0x2971('0x7d')]}));}this[_0x2971('0x9f')][_0x2971('0xa2')]((_0xbb8d03,_0x486d02)=>{const _0x42b59b=this[_0x2971('0x19')][_0x486d02];if(_0xbb8d03['onPlate']&&_0xbb8d03['plateId']!==null){const _0x35a832=this[_0x2971('0x19')][_0xbb8d03[_0x2971('0x73')]];const _0x2fac37=_0x35a832['oranges']['indexOf'](_0xbb8d03);if(_0x2fac37>-0x1){_0x35a832['oranges']['splice'](_0x2fac37,0x1);this[_0x2971('0x7c')](_0x35a832);}}_0x42b59b[_0x2971('0x47')][_0x2971('0xa3')](_0xbb8d03);_0xbb8d03['onPlate']=!![];_0xbb8d03[_0x2971('0x73')]=_0x42b59b['id'];this[_0x2971('0x7c')](_0x42b59b);});this[_0x2971('0x4')]++;this[_0x2971('0x9f')]=[];this[_0x2971('0x4f')]=[];this[_0x2971('0x83')]=![];this[_0x2971('0x60')]=![];this[_0x2971('0x9')]=null;this['canvas'][_0x2971('0x76')]['remove']('dragging-selection');let _0x51274f='';if(this['distributionCount']===0x1){_0x51274f=_0x2971('0x24');}else if(this['distributionCount']===0x2){_0x51274f='每份再各放1个，又分掉6个。';}else if(this['distributionCount']===0x3){_0x51274f=_0x2971('0x1d');setTimeout(()=>{this[_0x2971('0x6')]();},0x7d0);}else{_0x51274f=_0x2971('0x4c');}this['instruction'][_0x2971('0x2c')]=_0x51274f;setTimeout(()=>{this[_0x2971('0x37')]=[];},0xbb8);this['checkAllOrangesDistributed']();}['placeOrangeOnPlate'](_0x1a7121,_0x5b157a){if(_0x1a7121['onPlate']&&_0x1a7121[_0x2971('0x73')]!==null){const _0x349bb1=this[_0x2971('0x19')][_0x1a7121['plateId']];const _0x1d598a=_0x349bb1[_0x2971('0x47')][_0x2971('0x2b')](_0x1a7121);if(_0x1d598a>-0x1){_0x349bb1['oranges'][_0x2971('0x77')](_0x1d598a,0x1);}}_0x5b157a['oranges']['push'](_0x1a7121);this[_0x2971('0x7c')](_0x5b157a);_0x1a7121['onPlate']=!![];_0x1a7121['plateId']=_0x5b157a['id'];_0x1a7121['targetScale']=0x1;this[_0x2971('0xd')]();}['checkAllOrangesDistributed'](){const _0x235a4b=this['oranges'][_0x2971('0x57')];const _0x37d71e=this['oranges']['filter'](_0xf1a2a6=>_0xf1a2a6['onPlate'])[_0x2971('0x57')];if(_0x235a4b===0x12&&_0x37d71e===0x12){this['toggleModeBtn'][_0x2971('0x12')]['display']=_0x2971('0x8');this[_0x2971('0x7')]['style'][_0x2971('0x30')]='block';this[_0x2971('0x65')]['textContent']='所有橘子分配完成！';if(this[_0x2971('0x43')]){setTimeout(()=>{this['exitSelectMode']();},0x3e8);}}else{this[_0x2971('0x7')]['style']['display']=_0x2971('0x8');}}[_0x2971('0x3f')](){this['isSelectMode']=![];this[_0x2971('0x14')]['textContent']='圈分';this['toggleModeBtn']['classList'][_0x2971('0x23')]('active');this[_0x2971('0x18')]['classList'][_0x2971('0x23')]('select-mode');this[_0x2971('0x86')]();}[_0x2971('0x26')](_0x50e6d8,_0xc04143,_0x57a093){const _0x26ce25={'x':_0x50e6d8['x']+_0x50e6d8[_0x2971('0x6e')]/0x2,'y':_0x50e6d8['y']+_0x50e6d8['height']/0x2};const _0x3edfcf=0x28;const _0x12484a=0x28;if(_0x57a093===0x1){return{'x':_0x26ce25['x']-_0x3edfcf/0x2,'y':_0x26ce25['y']-_0x12484a/0x2};}else if(_0x57a093===0x2){const _0x3d7f46=0x32;return{'x':_0x26ce25['x']-_0x3edfcf/0x2+(_0xc04143-0.5)*_0x3d7f46,'y':_0x26ce25['y']-_0x12484a/0x2};}else if(_0x57a093===0x3){const _0x5c5630=[{'x':-0x19,'y':0x0},{'x':0x19,'y':0x0},{'x':0x0,'y':-0x28}];return{'x':_0x26ce25['x']-_0x3edfcf/0x2+_0x5c5630[_0xc04143]['x'],'y':_0x26ce25['y']-_0x12484a/0x2+_0x5c5630[_0xc04143]['y']};}else if(_0x57a093===0x4){const _0x227791=[{'x':-0x17,'y':-0x23},{'x':0x17,'y':-0x23},{'x':-0x19,'y':0xa},{'x':0x19,'y':0xa}];return{'x':_0x26ce25['x']-_0x3edfcf/0x2+_0x227791[_0xc04143]['x'],'y':_0x26ce25['y']-_0x12484a/0x2+_0x227791[_0xc04143]['y']};}else{const _0x16f62b=0x1e;const _0x5efce5=_0xc04143/_0x57a093*0x2*Math['PI'];return{'x':_0x26ce25['x']-_0x3edfcf/0x2+Math[_0x2971('0x34')](_0x5efce5)*_0x16f62b,'y':_0x26ce25['y']-_0x12484a/0x2+Math[_0x2971('0x98')](_0x5efce5)*_0x16f62b};}}['arrangeOrangesOnPlate'](_0x7ad3a7){const _0x14fc78=_0x7ad3a7['oranges']['length'];if(_0x14fc78===0x0)return;const _0x373ce3={'x':_0x7ad3a7['x']+_0x7ad3a7['width']/0x2,'y':_0x7ad3a7['y']+_0x7ad3a7[_0x2971('0x7d')]/0x2};if(_0x14fc78===0x1){const _0x5dff56=_0x7ad3a7[_0x2971('0x47')][0x0];_0x5dff56['x']=_0x373ce3['x']-_0x5dff56['width']/0x2;_0x5dff56['y']=_0x373ce3['y']-_0x5dff56['height']/0x2;}else if(_0x14fc78===0x2){const _0x4ae539=0x32;_0x7ad3a7[_0x2971('0x47')]['forEach']((_0x360cca,_0x54df1d)=>{_0x360cca['x']=_0x373ce3['x']-_0x360cca['width']/0x2+(_0x54df1d-0.5)*_0x4ae539;_0x360cca['y']=_0x373ce3['y']-_0x360cca['height']/0x2;});}else if(_0x14fc78===0x3){const _0x15adce=[{'x':-0x19,'y':0x0},{'x':0x19,'y':0x0},{'x':0x0,'y':-0x28}];_0x7ad3a7['oranges'][_0x2971('0xa2')]((_0x3bca53,_0x4284b1)=>{_0x3bca53['x']=_0x373ce3['x']-_0x3bca53[_0x2971('0x6e')]/0x2+_0x15adce[_0x4284b1]['x'];_0x3bca53['y']=_0x373ce3['y']-_0x3bca53['height']/0x2+_0x15adce[_0x4284b1]['y'];});}else if(_0x14fc78===0x4){const _0x1ab67a=[{'x':-0x17,'y':-0x23},{'x':0x17,'y':-0x23},{'x':-0x19,'y':0xa},{'x':0x19,'y':0xa}];_0x7ad3a7['oranges'][_0x2971('0xa2')]((_0x3fa3f9,_0x330ef0)=>{_0x3fa3f9['x']=_0x373ce3['x']-_0x3fa3f9['width']/0x2+_0x1ab67a[_0x330ef0]['x'];_0x3fa3f9['y']=_0x373ce3['y']-_0x3fa3f9[_0x2971('0x7d')]/0x2+_0x1ab67a[_0x330ef0]['y'];});}else{const _0x1e086f=0x1e;_0x7ad3a7[_0x2971('0x47')]['forEach']((_0x1840e9,_0x6eaa4a)=>{const _0x28ff16=_0x6eaa4a/_0x14fc78*0x2*Math['PI'];_0x1840e9['x']=_0x373ce3['x']-_0x1840e9[_0x2971('0x6e')]/0x2+Math[_0x2971('0x34')](_0x28ff16)*_0x1e086f;_0x1840e9['y']=_0x373ce3['y']-_0x1840e9[_0x2971('0x7d')]/0x2+Math['sin'](_0x28ff16)*_0x1e086f;});}}['returnOrangeToRandomPosition'](_0x141349){if(_0x141349[_0x2971('0x5c')]&&_0x141349[_0x2971('0x73')]!==null){const _0x49054c=this[_0x2971('0x19')][_0x141349['plateId']];const _0x5d57c3=_0x49054c[_0x2971('0x47')]['indexOf'](_0x141349);if(_0x5d57c3>-0x1){_0x49054c[_0x2971('0x47')]['splice'](_0x5d57c3,0x1);this['arrangeOrangesOnPlate'](_0x49054c);}}const _0x53ad8=0xa;const _0x1b3f61=this['canvas']['height']-0xc8;_0x141349['x']=Math[_0x2971('0x2e')]()*(this['canvas']['width']-_0x141349['width']-0x2*_0x53ad8)+_0x53ad8;_0x141349['y']=Math[_0x2971('0x2e')]()*(_0x1b3f61-_0x141349['height']-0x2*_0x53ad8)+_0x53ad8;_0x141349[_0x2971('0x5c')]=![];_0x141349['plateId']=null;_0x141349['targetScale']=0x1;}[_0x2971('0x88')](){this[_0x2971('0x47')]['forEach'](_0x541659=>{_0x541659[_0x2971('0x62')]+=(_0x541659[_0x2971('0x1c')]-_0x541659[_0x2971('0x62')])*0.2;});this['plates'][_0x2971('0xa2')](_0x441777=>{_0x441777['scale']+=(_0x441777['targetScale']-_0x441777['scale'])*0.2;});}[_0x2971('0x42')](){this['ctx']['clearRect'](0x0,0x0,this['canvas']['width'],this[_0x2971('0x18')][_0x2971('0x7d')]);if(this['ghostOranges']['length']>0x0){this['ctx']['save']();this['ctx']['globalAlpha']=0.3;this['ctx']['imageSmoothingEnabled']=!![];this['ctx'][_0x2971('0x3a')]='high';this['ghostOranges']['forEach'](_0x4d4894=>{const _0x404804=Math['round'](_0x4d4894['x']);const _0x3d11e5=Math[_0x2971('0x6a')](_0x4d4894['y']);const _0x3b687f=Math[_0x2971('0x6a')](_0x4d4894['width']);const _0xe5e52b=Math[_0x2971('0x6a')](_0x4d4894[_0x2971('0x7d')]);this[_0x2971('0x72')]['drawImage'](this['images'][_0x2971('0x44')],_0x404804,_0x3d11e5,_0x3b687f,_0xe5e52b);});this[_0x2971('0x72')]['restore']();}this['plates']['forEach'](_0x2972cd=>{this['ctx'][_0x2971('0x5d')]();const _0x6b776=_0x2972cd['x']+_0x2972cd[_0x2971('0x6e')]/0x2;const _0x378997=_0x2972cd['y']+_0x2972cd['height']/0x2;this[_0x2971('0x72')][_0x2971('0xa0')](_0x6b776,_0x378997);if(_0x2972cd[_0x2971('0x2d')]){this['ctx'][_0x2971('0x6d')]=_0x2971('0x16');}this[_0x2971('0x72')]['imageSmoothingEnabled']=!![];this[_0x2971('0x72')][_0x2971('0x3a')]=_0x2971('0xa1');const _0x1f6417=this[_0x2971('0x49')][_0x2971('0x6b')];const _0x4d7a57=_0x1f6417[_0x2971('0x6e')]/_0x1f6417['height'];let _0x322ef4=_0x2972cd['width']*_0x2972cd[_0x2971('0x62')];let _0x225f2a=_0x2972cd['width']*_0x2972cd[_0x2971('0x62')]/_0x4d7a57;if(_0x225f2a>_0x2972cd[_0x2971('0x7d')]*_0x2972cd[_0x2971('0x62')]){_0x225f2a=_0x2972cd['height']*_0x2972cd['scale'];_0x322ef4=_0x2972cd['height']*_0x2972cd['scale']*_0x4d7a57;}const _0x20ecd1=Math[_0x2971('0x6a')](-_0x322ef4/0x2);const _0x48766d=Math[_0x2971('0x6a')](-_0x225f2a/0x2);const _0x44dba0=Math[_0x2971('0x6a')](_0x322ef4);const _0x29677b=Math[_0x2971('0x6a')](_0x225f2a);this['ctx'][_0x2971('0x8a')](_0x1f6417,_0x20ecd1,_0x48766d,_0x44dba0,_0x29677b);this[_0x2971('0x72')][_0x2971('0x5e')]();});const _0x148dbc=[...this['oranges']];if(this['dragOrange']){const _0x1e39ba=_0x148dbc[_0x2971('0x2b')](this['dragOrange']);_0x148dbc['splice'](_0x1e39ba,0x1);_0x148dbc['push'](this['dragOrange']);}_0x148dbc['forEach'](_0x5ba918=>{this['ctx']['save']();const _0x7739f3=_0x5ba918['x']+_0x5ba918['width']/0x2;const _0x396c33=_0x5ba918['y']+_0x5ba918['height']/0x2;this['ctx'][_0x2971('0xa0')](_0x7739f3,_0x396c33);this['ctx']['scale'](_0x5ba918['scale'],_0x5ba918['scale']);this[_0x2971('0x72')][_0x2971('0x3c')]=!![];this['ctx']['imageSmoothingQuality']=_0x2971('0xa1');if(this[_0x2971('0x9f')][_0x2971('0x85')](_0x5ba918)){this[_0x2971('0x72')]['shadowColor']=_0x2971('0x20');this[_0x2971('0x72')]['shadowBlur']=0xa;}const _0x158997=Math['round'](-_0x5ba918['width']/0x2);const _0x364c2d=Math['round'](-_0x5ba918[_0x2971('0x7d')]/0x2);const _0x121d8a=Math[_0x2971('0x6a')](_0x5ba918[_0x2971('0x6e')]);const _0x3dcc1c=Math[_0x2971('0x6a')](_0x5ba918['height']);this['ctx'][_0x2971('0x8a')](this[_0x2971('0x49')]['orange'],_0x158997,_0x364c2d,_0x121d8a,_0x3dcc1c);this[_0x2971('0x72')]['restore']();});if(this['isSelectMode']&&this['selectionPath']['length']>0x0){this['ctx']['save']();if(this[_0x2971('0x9f')][_0x2971('0x57')]===0x6){this[_0x2971('0x72')]['strokeStyle']='#4CAF50';this['ctx'][_0x2971('0x5a')]='rgba(76,\x20175,\x2080,\x200.1)';}else{this[_0x2971('0x72')][_0x2971('0x96')]='#FF6B35';this[_0x2971('0x72')]['fillStyle']='rgba(255,\x20107,\x2053,\x200.1)';}this['ctx']['lineWidth']=0x3;this[_0x2971('0x72')]['lineCap']='round';this['ctx']['lineJoin']=_0x2971('0x6a');if(this['selectionPath']['length']>0x2&&!this[_0x2971('0x83')]){this[_0x2971('0x72')]['beginPath']();this['ctx']['moveTo'](this[_0x2971('0x4f')][0x0]['x'],this['selectionPath'][0x0]['y']);for(let _0xc69398=0x1;_0xc69398<this[_0x2971('0x4f')]['length'];_0xc69398++){this['ctx']['lineTo'](this[_0x2971('0x4f')][_0xc69398]['x'],this['selectionPath'][_0xc69398]['y']);}this['ctx'][_0x2971('0x5b')]();this[_0x2971('0x72')][_0x2971('0x59')]();}this['ctx']['beginPath']();if(this[_0x2971('0x4f')]['length']>0x0){this[_0x2971('0x72')]['moveTo'](this['selectionPath'][0x0]['x'],this['selectionPath'][0x0]['y']);for(let _0x4a1e97=0x1;_0x4a1e97<this[_0x2971('0x4f')]['length'];_0x4a1e97++){this['ctx']['lineTo'](this[_0x2971('0x4f')][_0x4a1e97]['x'],this[_0x2971('0x4f')][_0x4a1e97]['y']);}if(!this['isSelecting']&&this[_0x2971('0x4f')]['length']>0x2){this[_0x2971('0x72')][_0x2971('0x5b')]();}}this['ctx'][_0x2971('0x79')]();if(this[_0x2971('0x9f')]['length']>0x0&&this[_0x2971('0x4f')]['length']>0x2){let _0x5b3c94=0x0,_0x469b9c=0x0;this['selectionPath'][_0x2971('0xa2')](_0x25b29f=>{_0x5b3c94+=_0x25b29f['x'];_0x469b9c+=_0x25b29f['y'];});_0x5b3c94/=this['selectionPath'][_0x2971('0x57')];_0x469b9c/=this['selectionPath']['length'];this[_0x2971('0x72')]['fillStyle']=this['selectedOranges']['length']===0x6?_0x2971('0x52'):_0x2971('0x35');this[_0x2971('0x72')]['font']='bold\x2016px\x20Arial';this['ctx'][_0x2971('0x1a')]='center';this['ctx'][_0x2971('0x36')](_0x2971('0x48')+this[_0x2971('0x9f')][_0x2971('0x57')],_0x5b3c94,_0x469b9c-0xa);this['ctx'][_0x2971('0x1a')]='left';}this[_0x2971('0x72')]['restore']();}}['gameLoop'](){this[_0x2971('0x88')]();this[_0x2971('0x42')]();requestAnimationFrame(()=>this[_0x2971('0x15')]());}['calculateDistance'](_0x51af46,_0x4fca64){const _0x41e6c7=_0x51af46['x']+_0x51af46['width']/0x2;const _0x5a0c8c=_0x51af46['y']+_0x51af46[_0x2971('0x7d')]/0x2;const _0x5b14ee=_0x4fca64['x']+_0x4fca64['width']/0x2;const _0x3d01db=_0x4fca64['y']+_0x4fca64['height']/0x2;return Math[_0x2971('0x92')](Math[_0x2971('0x6f')](_0x41e6c7-_0x5b14ee,0x2)+Math['pow'](_0x5a0c8c-_0x3d01db,0x2));}['findClosestOranges'](_0x3a100e,_0x21bcf7,_0x2ba8ad){const _0x18d8b1=_0x21bcf7['map'](_0x29ad73=>({'orange':_0x29ad73,'distance':this['calculateDistance'](_0x29ad73,_0x3a100e)}));_0x18d8b1[_0x2971('0x10')]((_0x22ee9f,_0x2e5140)=>_0x22ee9f['distance']-_0x2e5140['distance']);return _0x18d8b1[_0x2971('0x89')](0x0,_0x2ba8ad)['map'](_0x496b36=>_0x496b36[_0x2971('0x44')]);}[_0x2971('0x3b')](_0x5c63de){this['autoDistributeMode']=_0x5c63de;this['autoDistributeIndex']=0x0;this['autoDistributeCount']=0x0;this['updateAutoButtonStates']();this['instruction'][_0x2971('0x2c')]=_0x2971('0x50')+_0x5c63de+'个'+_0x5c63de+_0x2971('0x8c');this['performAutoDistribute']();}[_0x2971('0xe')](){this['autoBtn1']['classList']['remove']('active');this[_0x2971('0x1f')][_0x2971('0x76')]['remove']('active');this[_0x2971('0x9a')]['classList']['remove'](_0x2971('0x9d'));if(this['autoDistributeMode']===0x1){this[_0x2971('0x82')]['classList']['add'](_0x2971('0x9d'));}else if(this[_0x2971('0x27')]===0x2){this['autoBtn2']['classList'][_0x2971('0x3e')]('active');}else if(this['autoDistributeMode']===0x3){this['autoBtn3']['classList'][_0x2971('0x3e')](_0x2971('0x9d'));}}[_0x2971('0x7e')](_0x468a2a,_0xfc310c,_0x3d5bde=0x0,_0xbed824=null){return new Promise(_0x1bcd2a=>{setTimeout(()=>{const _0x2fa60c={'x':_0x468a2a['x'],'y':_0x468a2a['y']};let _0x1e634f;if(_0xbed824!==null){const _0x28dac3=_0xfc310c['oranges']['length'];_0x1e634f=this['calculateOrangePosition'](_0xfc310c,_0x28dac3,_0xbed824);}else{_0xfc310c[_0x2971('0x47')][_0x2971('0xa3')](_0x468a2a);_0x468a2a['onPlate']=!![];_0x468a2a['plateId']=_0xfc310c['id'];this['arrangeOrangesOnPlate'](_0xfc310c);_0x1e634f={'x':_0x468a2a['x'],'y':_0x468a2a['y']};_0x468a2a['x']=_0x2fa60c['x'];_0x468a2a['y']=_0x2fa60c['y'];_0xfc310c['oranges'][_0x2971('0x69')]();_0x468a2a[_0x2971('0x5c')]=![];_0x468a2a['plateId']=null;}const _0x3e042a=this;const _0x49fbea=Date[_0x2971('0x41')]();const _0x1e46e2=0xc8;const _0x368099=()=>{const _0x13a679=Date[_0x2971('0x41')]()-_0x49fbea;const _0x3a53f0=Math['min'](_0x13a679/_0x1e46e2,0x1);const _0xbb0c93=0x1-Math['pow'](0x1-_0x3a53f0,0x3);_0x468a2a['x']=_0x2fa60c['x']+(_0x1e634f['x']-_0x2fa60c['x'])*_0xbb0c93;_0x468a2a['y']=_0x2fa60c['y']+(_0x1e634f['y']-_0x2fa60c['y'])*_0xbb0c93;_0x3e042a['render']();if(_0x3a53f0<0x1){requestAnimationFrame(_0x368099);}else{_0xfc310c[_0x2971('0x47')]['push'](_0x468a2a);_0x468a2a[_0x2971('0x5c')]=!![];_0x468a2a['plateId']=_0xfc310c['id'];_0x3e042a[_0x2971('0x7c')](_0xfc310c);_0x3e042a['render']();_0x1bcd2a();}};requestAnimationFrame(_0x368099);},_0x3d5bde);});}async['performAutoDistribute'](){if(this[_0x2971('0x27')]===0x0)return;const _0x1d9344=this['oranges'][_0x2971('0x6d')](_0x456675=>!_0x456675['onPlate']);if(_0x1d9344[_0x2971('0x57')]===0x0){this[_0x2971('0x27')]=0x0;this['updateAutoButtonStates']();this[_0x2971('0x65')][_0x2971('0x2c')]='所有橘子分配完成！';this[_0x2971('0x14')]['style']['display']=_0x2971('0x8');this['resetBtn']['style']['display']=_0x2971('0x46');return;}const _0x53ac9f=Math['min'](this[_0x2971('0x27')],_0x1d9344[_0x2971('0x57')]);const _0x2745b9=this[_0x2971('0x19')][this[_0x2971('0x53')]];if(this['autoDistributeMode']===0x2){const _0x13d15d=this[_0x2971('0x19')][_0x2971('0x6d')](_0x466733=>_0x466733['oranges'][_0x2971('0x57')]>=0x2)[_0x2971('0x57')];if(_0x13d15d===0x6&&_0x1d9344[_0x2971('0x57')]===0x6){this['autoDistributeMode']=0x0;this[_0x2971('0xe')]();this['instruction']['textContent']='第一轮分配完成！每个盘子2个，剩余6个橘子。';this['toggleModeBtn'][_0x2971('0x12')][_0x2971('0x30')]='none';this['resetBtn']['style'][_0x2971('0x30')]='block';return;}}const _0x28e3de=this['findClosestOranges'](_0x2745b9,_0x1d9344,_0x53ac9f);const _0x3a62af=[];for(let _0x5b02b3=0x0;_0x5b02b3<_0x28e3de['length'];_0x5b02b3++){const _0x539ae3=_0x28e3de[_0x5b02b3];const _0x3c3a9a=_0x5b02b3*0x64;const _0x21d1ae=_0x2745b9['oranges'][_0x2971('0x57')]+_0x5b02b3;const _0x59991f=_0x2745b9[_0x2971('0x47')]['length']+_0x28e3de['length'];_0x3a62af[_0x2971('0xa3')](this['animateOrangeToPlate'](_0x539ae3,_0x2745b9,_0x3c3a9a,_0x59991f));}await Promise[_0x2971('0x67')](_0x3a62af);this['autoDistributeCount']+=_0x28e3de['length'];this['autoDistributeIndex']=(this[_0x2971('0x53')]+0x1)%0x6;const _0x19bb47=this['oranges'][_0x2971('0x6d')](_0x12998a=>!_0x12998a['onPlate'])[_0x2971('0x57')];this[_0x2971('0x65')]['textContent']=this[_0x2971('0x27')]+'个'+this[_0x2971('0x27')]+_0x2971('0x90')+_0x19bb47+_0x2971('0x70');if(this[_0x2971('0x53')]===0x0){if(_0x19bb47>0x0){setTimeout(()=>{this['performAutoDistribute']();},0x12c);}else{this[_0x2971('0x27')]=0x0;this['updateAutoButtonStates']();this[_0x2971('0x65')]['textContent']='所有橘子分配完成！';this['toggleModeBtn']['style']['display']=_0x2971('0x8');this[_0x2971('0x7')][_0x2971('0x12')][_0x2971('0x30')]='block';}}else{setTimeout(()=>{this[_0x2971('0xc')]();},0x12c);}}}window[_0x2971('0x33')]('load',()=>{new CanvasDragGame();});
    </script>
</body>
</html>
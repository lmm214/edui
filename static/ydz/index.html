<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <title>云朵字生成器</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="./src/all.css">
    </head>
    
    <body>
        <div class="app-container">            
            <div class="app-content">
                <!-- 控制面板 - 第一行3列 -->
                <div class="controls-panel">
                    <h2>☁️ 云朵字生成器</h2>
                    <div class="control-group wenzi">
                        <div class="control-item">
                            <label>内容</label>
                            <input type="text" id="textInput" value="edui123" placeholder="输入您想要设计的文字...">
                        </div>
                        <div class="control-item">
                            <label>字体</label>
                            <select id="fontSelect">
                                <optgroup label="系统字体">
                                    <option value="ABeeZee-Italic" selected>ABeeZee</option>
                                    <option value="ABeeZee-Regular">ABeeZee（常规）</option>
                                    <option value="XuMin">徐珉体</option>
                                    <option value="Comic Sans MS">Comic Sans MS</option>
                                    <option value="Times New Roman">Times New Roman</option>
                                </optgroup>
                                <optgroup label="在线字体" id="onlineFontsGroup">
                                    <!-- 在线字体选项将通过JavaScript动态生成 -->
                                </optgroup>
                            </select>
                        </div>
                        <div class="control-item">
                            <label>本地</label>
                            <input type="file" id="fontFile" accept=".ttf,.otf,.woff,.woff2">
                        </div>
                        <div class="control-item">
                            <label>字重</label>
                            <div class="range-container">
                                <input type="range" id="fontWeight" min="100" max="900" value="400" step="100">
                                <span class="range-value" id="fontWeightValue">400</span>
                            </div>
                        </div>
                        <div class="control-item">
                            <label>字号</label>
                            <div class="range-container">
                                <input type="range" id="fontSize" min="50" max="500" value="255">
                                <span class="range-value" id="fontSizeValue">255</span>
                            </div>
                        </div>
                        <div class="control-item">
                            <label>间距</label>
                            <div class="range-container">
                                <input type="range" id="letterSpacing" min="-30" max="80" value="0">
                                <span class="range-value" id="letterSpacingValue">0</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="controls-neiwai-panel">
                <div class="controls-panel">
                    <h3>🛞 内外厚度</h3>
                    <div class="control-group neiwai">
                        <div class="control-item">
                            <label>内层</label>
                            <div class="range-container">
                                <input type="range" id="whiteSize" min="5" max="100" value="50" step="5">
                                <span class="range-value" id="whiteSizeValue">50</span>
                            </div>
                        </div>
                        <div class="control-item">
                            <label>外层</label>
                            <div class="range-container">
                                <input type="range" id="outlineSize" min="5" max="100" value="50" step="5">
                                <span class="range-value" id="outlineSizeValue">50</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="controls-panel">
                    <h3>🎨 颜色调整</h3>
                    <div class="control-group yanse">
                        <div class="control-item">
                            <label>外层</label>
                            <input type="color" id="outlineColor" value="#ff6b6b">
                        </div>
                        <div class="control-item">
                            <label>内层</label>
                            <input type="color" id="innerColor" value="#ffffff">
                        </div>
                        <div class="control-item">
                            <label>文字</label>
                            <input type="color" id="textColor" value="#333333">
                        </div>
                    </div>
                </div>
                </div>
                
                <div class="download-section">
                    <button onclick="downloadSingle()">💾 下载高清透明图片</button>
                </div>
                <!-- 实时预览区域 - 第三行整行 -->
                <div class="preview-section">
                    <canvas id="previewCanvas" width="1200" height="500"></canvas>
                </div>


                <div class="controls-panel online-fonts">
                    <h3>🔗 在线字体</h3>
                    <div class="control-group" id="onlineFontsContainer">
                        <!-- 在线字体按钮将通过JavaScript动态生成 -->
                    </div>
                </div>
            </div>
        </div>
    
        <script>
const _0xbe1f=['touchmove','addEventListener','getContext','fontWeight','value','touchend','className','#loading-tip-style','fontSize','height','fontSelect','cloudText_content','loading-tip-style','无法保存设置到本地存储:','fontSizeValue','option','已加载','min','message','monospace','Mengshen-Handwritten','length','加载失败','strokeText','animation','classList','https://fontsapi.zeoseven.com/477/main/result.css','has','innerHTML','span','error','猫啃珠圆体','dblclick','forEach','actualBoundingBoxDescent','resolve','textContent','measureText','mousemove','fontStyle','source-over','outlineSize','https://fontsapi.zeoseven.com/243/main/result.css','fontFamily','https://fontsapi.zeoseven.com/121/main/result.css','loading','canvas','head','cloudText_settings','https://fontsapi.zeoseven.com/236/main/result.css','style','https://fontsapi.zeoseven.com/92/main/result.css','\x20(自定义)','https://fontsapi.zeoseven.com/494/main/result.css','.font-load-btn','临海隶书','https://fontsapi.zeoseven.com/46/main/result.css','mouseleave','峄山碑篆体','querySelectorAll','lineWidth','得意黑','outlineSizeValue','name','max','https://fontsapi.zeoseven.com/88/main/result.css','rel','top','.font-loading-tip','https://fontsapi.zeoseven.com/36/main/result.css','https://fontsapi.zeoseven.com/285/main/result.css','textColor','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22font-name\x22>','whiteSize','字体加载失败:\x20','AR\x20PL\x20UKai\x20CN','link','\x20字体加载超时','字体加载超时','无法保存到本地存储:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20top:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20right:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background:\x20rgba(102,\x20126,\x20234,\x200.9);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20white;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2012px\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x201000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.15);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20animation:\x20slideIn\x200.3s\x20ease;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','appendChild','stylesheet','cursor','querySelector','.load-status','云峰飞云体','data-font','now','.png','disabled','小石头体','load',',\x20monospace;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','move','getItem','toTimeString','cssText','font-load-btn','寒蝉半圆体','https://fontsapi.zeoseven.com/446/main/result.css','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22load-status\x22>点击加载</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','clientY','\x20字体...','target','huangkaihuaLawyerfont','type','fontWeightValue','remove','createElement','click','https://fontsapi.zeoseven.com/5/main/result.css','https://fontsapi.zeoseven.com/309/main/result.css','text','思源宋体','字体不可用','CaoShu\x20Simp2Trad','then','button','slideIn\x200.3s\x20ease\x20reverse','Reggae','汇文明朝体','parse','createObjectURL','width','textInput','textBaseline','left','clientX','\x20字体加载失败','round','大宝桃桃体','getElementById','CSS加载失败','warn','change','MuyaoPleased','无法从本地存储读取:','ToneOZ-Pinyin-WenKai-Regular','offsetWidth','touchstart','download','globalCompositeOperation','outlineColor','fonts','getBoundingClientRect','innerColor','https://fontsapi.zeoseven.com/84/main/result.css','add','letterSpacing','加载中...','body','mouseup','split'];const _0x4cb8=function(_0xbe1f4,_0x4cb8f5){_0xbe1f4=_0xbe1f4-0x0;let _0x2460cf=_0xbe1f[_0xbe1f4];return _0x2460cf;};let currentDesign=null;let batchItems=[];const previewCanvas=document[_0x4cb8('0x84')]('previewCanvas');const ctx=previewCanvas[_0x4cb8('0x2')]('2d');let isDragging=![];let dragStartX=0x0;let dragStartY=0x0;let offsetX=0x0;let offsetY=0x0;let lastTouchX=0x0;let lastTouchY=0x0;const loadedFonts=new Set();const onlineFonts=[{'id':'YEFONTXiaoShiTou','name':_0x4cb8('0x5b'),'cssUrl':_0x4cb8('0x38')},{'id':'TsangerXWZ','name':'仓耳小丸子','cssUrl':_0x4cb8('0x1a')},{'id':'MaokenZhuyuanTi','name':_0x4cb8('0x1f'),'cssUrl':_0x4cb8('0x41')},{'id':'寒蝉半圆体','name':_0x4cb8('0x63'),'cssUrl':_0x4cb8('0x2a')},{'id':_0x4cb8('0x14'),'name':'萌神拼音体','cssUrl':'https://fontsapi.zeoseven.com/137/main/result.css'},{'id':_0x4cb8('0x8a'),'name':'澳声通拼音文楷','cssUrl':'https://fontsapi.zeoseven.com/600/main/result.css'},{'id':'Unifont','name':'像素字体','cssUrl':'https://fontsapi.zeoseven.com/572/main/result.css'},{'id':_0x4cb8('0x78'),'name':'雷盖体','cssUrl':'https://fontsapi.zeoseven.com/102/main/result.css'},{'id':'DaBaoTaoTaoTi','name':_0x4cb8('0x83'),'cssUrl':'https://fontsapi.zeoseven.com/41/main/result.css'},{'id':_0x4cb8('0x88'),'name':'沐瑶随心手写体','cssUrl':_0x4cb8('0x2c')},{'id':_0x4cb8('0x69'),'name':'黄凯桦手写体','cssUrl':'https://fontsapi.zeoseven.com/223/main/result.css'},{'id':'YFFYT','name':_0x4cb8('0x56'),'cssUrl':_0x4cb8('0x64')},{'id':'PING\x20FANG\x20GONG\x20ZI\x20TI','name':'平方公子体','cssUrl':_0x4cb8('0x35')},{'id':'DouyinSans','name':'抖音美好体','cssUrl':_0x4cb8('0x93')},{'id':'STDongGuanTi','name':'上图东观体','cssUrl':'https://fontsapi.zeoseven.com/488/main/result.css'},{'id':'ChillKai','name':'寒蝉正楷体','cssUrl':_0x4cb8('0x6f')},{'id':_0x4cb8('0x4b'),'name':'文鼎楷体','cssUrl':'https://fontsapi.zeoseven.com/577/main/result.css'},{'id':'CooperZhengKai','name':'汇迹正楷','cssUrl':'https://fontsapi.zeoseven.com/482/main/result.css'},{'id':'TW-Kai','name':'全字库正楷体','cssUrl':_0x4cb8('0x45')},{'id':'KingHwa_OldSong','name':'京华老宋体','cssUrl':_0x4cb8('0x70')},{'id':'Noto\x20Serif\x20CJK','name':_0x4cb8('0x72'),'cssUrl':_0x4cb8('0x46')},{'id':'Zhuque\x20Fangsong\x20(technical\x20preview)','name':'朱雀仿宋','cssUrl':'https://fontsapi.zeoseven.com/7/main/result.css'},{'id':'Smiley\x20Sans\x20Oblique','name':_0x4cb8('0x3d'),'cssUrl':_0x4cb8('0x33')},{'id':'Huiwen-mincho','name':_0x4cb8('0x79'),'cssUrl':'https://fontsapi.zeoseven.com/256/main/result.css'},{'id':'峄山碑篆体','name':_0x4cb8('0x3a'),'cssUrl':_0x4cb8('0x31')},{'id':'临海体','name':_0x4cb8('0x37'),'cssUrl':'https://fontsapi.zeoseven.com/229/main/result.css'},{'id':_0x4cb8('0x74'),'name':'草书','cssUrl':'https://fontsapi.zeoseven.com/107/main/result.css'}];function generateOnlineFontsHTML(){const _0x23e9b3=document['getElementById']('onlineFontsGroup');_0x23e9b3[_0x4cb8('0x1c')]='';onlineFonts[_0x4cb8('0x21')](_0x518aef=>{const _0x482b05=document[_0x4cb8('0x6d')]('option');_0x482b05['value']=_0x518aef['id'];_0x482b05[_0x4cb8('0x24')]=_0x518aef['name'];_0x482b05[_0x4cb8('0x5a')]=!![];_0x482b05[_0x4cb8('0x6')]='online-font-option';_0x23e9b3[_0x4cb8('0x51')](_0x482b05);});const _0x297ae5=document[_0x4cb8('0x84')]('onlineFontsContainer');_0x297ae5[_0x4cb8('0x1c')]='';onlineFonts[_0x4cb8('0x21')](_0x431cb4=>{const _0x197302=document['createElement'](_0x4cb8('0x76'));_0x197302[_0x4cb8('0x6')]=_0x4cb8('0x62');_0x197302['setAttribute'](_0x4cb8('0x57'),_0x431cb4['id']);_0x197302['setAttribute']('data-name',_0x431cb4['name']);_0x197302[_0x4cb8('0x1c')]=_0x4cb8('0x48')+_0x431cb4[_0x4cb8('0x3f')]+_0x4cb8('0x65');_0x297ae5[_0x4cb8('0x51')](_0x197302);});}function showLoadingTip(_0x103681){const _0x2c607f=document[_0x4cb8('0x54')](_0x4cb8('0x44'));if(_0x2c607f){_0x2c607f[_0x4cb8('0x6c')]();}const _0x52e690=document[_0x4cb8('0x6d')]('div');_0x52e690[_0x4cb8('0x6')]='font-loading-tip';_0x52e690[_0x4cb8('0x32')][_0x4cb8('0x61')]=_0x4cb8('0x50');_0x52e690['textContent']=_0x103681;document[_0x4cb8('0x97')][_0x4cb8('0x51')](_0x52e690);if(!document[_0x4cb8('0x54')](_0x4cb8('0x7'))){const _0x5be2f1=document['createElement'](_0x4cb8('0x32'));_0x5be2f1['id']=_0x4cb8('0xc');_0x5be2f1[_0x4cb8('0x24')]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@keyframes\x20slideIn\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20from\x20{\x20transform:\x20translateX(100%);\x20opacity:\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20to\x20{\x20transform:\x20translateX(0);\x20opacity:\x201;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';document[_0x4cb8('0x2f')]['appendChild'](_0x5be2f1);}return _0x52e690;}function hideLoadingTip(){const _0x54f8d1=document[_0x4cb8('0x54')](_0x4cb8('0x44'));if(_0x54f8d1){_0x54f8d1['style'][_0x4cb8('0x18')]=_0x4cb8('0x77');setTimeout(()=>_0x54f8d1[_0x4cb8('0x6c')](),0x12c);}}function checkFontAvailable(_0x14f82b){return new Promise(_0xc91a11=>{const _0x41c42f=document['createElement'](_0x4cb8('0x1d'));_0x41c42f['style']['cssText']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20position:\x20absolute;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20visibility:\x20hidden;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2072px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20'+_0x14f82b+_0x4cb8('0x5d');_0x41c42f['textContent']='测试字体ABCabc';document[_0x4cb8('0x97')][_0x4cb8('0x51')](_0x41c42f);_0x41c42f['style'][_0x4cb8('0x2b')]=_0x4cb8('0x13');const _0x1fe041=_0x41c42f[_0x4cb8('0x8b')];_0x41c42f['style'][_0x4cb8('0x2b')]='\x22'+_0x14f82b+'\x22,\x20monospace';let _0x5aeeb6=0x0;const _0xf989b9=0x32;const _0x54aeee=()=>{const _0x2604f8=_0x41c42f['offsetWidth'];_0x5aeeb6++;if(_0x2604f8!==_0x1fe041||_0x5aeeb6>=_0xf989b9){document[_0x4cb8('0x97')]['removeChild'](_0x41c42f);_0xc91a11(_0x2604f8!==_0x1fe041);}else{setTimeout(_0x54aeee,0x64);}};_0x54aeee();});}function loadOnlineFont(_0x4d4d30){if(loadedFonts[_0x4cb8('0x1b')](_0x4d4d30)){return Promise['resolve']();}const _0x533c33=onlineFonts['find'](_0x350346=>_0x350346['id']===_0x4d4d30);if(!_0x533c33){return Promise[_0x4cb8('0x23')]();}const {cssUrl,name:_0x432be4}=_0x533c33;if(cssUrl){const _0x318303=showLoadingTip('正在加载\x20'+_0x432be4+_0x4cb8('0x67'));const _0x4969ec=Date[_0x4cb8('0x58')]();return new Promise((_0xc3fd5b,_0x327024)=>{const _0xd5ad0e=document[_0x4cb8('0x6d')](_0x4cb8('0x4c'));_0xd5ad0e[_0x4cb8('0x42')]=_0x4cb8('0x52');_0xd5ad0e['href']=cssUrl;const _0x35e2af=setTimeout(()=>{hideLoadingTip();showLoadingTip(_0x432be4+_0x4cb8('0x4d'));setTimeout(hideLoadingTip,0x7d0);_0x327024(new Error(_0x4cb8('0x4e')));},0x2710);_0xd5ad0e['onload']=()=>{clearTimeout(_0x35e2af);checkFontAvailable(_0x4d4d30)['then'](_0x1d889d=>{const _0x4856df=Date[_0x4cb8('0x58')]()-_0x4969ec;const _0x4a01fe=0xbb8;const _0x25d240=Math[_0x4cb8('0x40')](0x0,_0x4a01fe-_0x4856df);setTimeout(()=>{hideLoadingTip();if(_0x1d889d){loadedFonts['add'](_0x4d4d30);showLoadingTip(_0x432be4+'\x20字体加载成功！');setTimeout(hideLoadingTip,0x7d0);_0xc3fd5b();}else{showLoadingTip(_0x432be4+_0x4cb8('0x81'));setTimeout(hideLoadingTip,0xbb8);_0x327024(new Error(_0x4cb8('0x73')));}},_0x25d240);});};_0xd5ad0e['onerror']=()=>{clearTimeout(_0x35e2af);hideLoadingTip();showLoadingTip(_0x432be4+'\x20字体加载失败');setTimeout(hideLoadingTip,0xbb8);_0x327024(new Error(_0x4cb8('0x85')));};document[_0x4cb8('0x2f')][_0x4cb8('0x51')](_0xd5ad0e);});}return Promise[_0x4cb8('0x23')]();}function initControls(){loadTextFromStorage();loadAllSettingsFromStorage();generateOnlineFontsHTML();const _0x1a4a8e=document['getElementById']('fontSelect');let _0x413638=_0x1a4a8e[_0x4cb8('0x4')];_0x1a4a8e[_0x4cb8('0x1')]('change',function(){generatePreview();_0x413638=this[_0x4cb8('0x4')];});_0x1a4a8e[_0x4cb8('0x1')]('click',function(){if(this['value']===_0x413638&&this[_0x4cb8('0x4')]){generatePreview();}});document['querySelectorAll'](_0x4cb8('0x36'))[_0x4cb8('0x21')](_0x25a40b=>{_0x25a40b['addEventListener'](_0x4cb8('0x6e'),function(){const _0x82d5a6=this['dataset']['font'];const _0x3d494a=this['dataset'][_0x4cb8('0x3f')];if(loadedFonts[_0x4cb8('0x1b')](_0x82d5a6)){document['getElementById'](_0x4cb8('0xa'))[_0x4cb8('0x4')]=_0x82d5a6;document['fonts']['ready'][_0x4cb8('0x75')](()=>{setTimeout(()=>{generatePreview();},0x64);});return;}this['classList']['add'](_0x4cb8('0x2d'));this[_0x4cb8('0x54')]('.load-status')['textContent']=_0x4cb8('0x96');this[_0x4cb8('0x5a')]=!![];loadOnlineFont(_0x82d5a6)['then'](()=>{this[_0x4cb8('0x19')][_0x4cb8('0x6c')](_0x4cb8('0x2d'));this[_0x4cb8('0x19')][_0x4cb8('0x94')]('loaded');this['querySelector']('.load-status')['textContent']=_0x4cb8('0x10');this[_0x4cb8('0x5a')]=![];const _0xf9ce7=document['querySelector']('option[value=\x22'+_0x82d5a6+'\x22]');if(_0xf9ce7){_0xf9ce7['disabled']=![];_0xf9ce7[_0x4cb8('0x32')]['color']='#000';_0xf9ce7[_0x4cb8('0x32')][_0x4cb8('0x27')]='normal';}})['catch'](_0xef282f=>{console[_0x4cb8('0x1e')]('字体加载失败:',_0xef282f);this[_0x4cb8('0x19')][_0x4cb8('0x6c')](_0x4cb8('0x2d'));this['classList'][_0x4cb8('0x94')](_0x4cb8('0x1e'));this[_0x4cb8('0x54')]('.load-status')['textContent']=_0x4cb8('0x16');this[_0x4cb8('0x5a')]=![];setTimeout(()=>{this[_0x4cb8('0x19')]['remove'](_0x4cb8('0x1e'));this['querySelector'](_0x4cb8('0x55'))['textContent']='点击加载';},0xbb8);});});});document[_0x4cb8('0x3b')]('input')['forEach'](_0x415b08=>{_0x415b08['addEventListener']('input',function(){generatePreview();if(this['id']==='textInput'){saveTextToStorage(this['value']);}if(this[_0x4cb8('0x6a')]!=='file'){saveAllSettingsToStorage();}});});document['querySelectorAll']('select')[_0x4cb8('0x21')](_0x10d4e4=>{_0x10d4e4['addEventListener']('change',function(){generatePreview();saveAllSettingsToStorage();});});linkRangeValue(_0x4cb8('0x29'),_0x4cb8('0x3e'));linkRangeValue('whiteSize','whiteSizeValue');linkRangeValue('fontSize',_0x4cb8('0xe'));linkRangeValue('letterSpacing','letterSpacingValue');linkRangeValue('fontWeight',_0x4cb8('0x6b'));}function linkRangeValue(_0x335ac0,_0xfd8186){const _0x454f55=document[_0x4cb8('0x84')](_0x335ac0);const _0x11be74=document['getElementById'](_0xfd8186);_0x454f55['addEventListener']('input',()=>{if(_0x335ac0===_0x4cb8('0x29')){const _0x8f4e9e=parseInt(document['getElementById']('whiteSize')['value']);const _0x27c459=parseInt(_0x454f55['value']);_0x11be74[_0x4cb8('0x24')]=_0x8f4e9e+_0x27c459;}else{_0x11be74['textContent']=_0x454f55[_0x4cb8('0x4')];}});if(_0x335ac0===_0x4cb8('0x49')){_0x454f55[_0x4cb8('0x1')]('input',()=>{const _0x120cb8=document[_0x4cb8('0x84')]('outlineSizeValue');const _0x55d3e4=parseInt(document['getElementById'](_0x4cb8('0x29'))['value']);const _0x4b87b4=parseInt(_0x454f55['value']);_0x120cb8['textContent']=_0x4b87b4+_0x55d3e4;});}}function generatePreview(){const _0x912b91=getParams();drawCloudText(ctx,_0x912b91,0x1);currentDesign=_0x912b91;}function downloadSingle(){if(!currentDesign)return;const _0x42a56d=createCanvas(currentDesign,currentDesign['exportScale']);const _0x25d2e3=trimCanvas(_0x42a56d);const _0x22c884=document[_0x4cb8('0x6d')]('a');const _0x26cc6=new Date();const _0x5e580c=_0x26cc6[_0x4cb8('0x60')]()['slice'](0x0,0x8)['replace'](/:/g,'');_0x22c884[_0x4cb8('0x8d')]=currentDesign[_0x4cb8('0x71')]+'-'+_0x5e580c+_0x4cb8('0x59');_0x22c884['href']=_0x25d2e3['toDataURL']('image/png');_0x22c884['click']();}function trimCanvas(_0x19c804){const _0x283419=_0x19c804[_0x4cb8('0x2')]('2d');const _0x2a65dc=_0x283419['getImageData'](0x0,0x0,_0x19c804[_0x4cb8('0x7c')],_0x19c804['height']);const _0x5784b3=_0x2a65dc['data'];let _0x5d7ee1=_0x19c804['width'];let _0x484e08=_0x19c804[_0x4cb8('0x9')];let _0x56672c=0x0;let _0xe26a65=0x0;for(let _0x5cdec1=0x0;_0x5cdec1<_0x19c804['height'];_0x5cdec1++){for(let _0x4a01ff=0x0;_0x4a01ff<_0x19c804[_0x4cb8('0x7c')];_0x4a01ff++){const _0x4cbe57=_0x5784b3[(_0x5cdec1*_0x19c804[_0x4cb8('0x7c')]+_0x4a01ff)*0x4+0x3];if(_0x4cbe57>0x0){_0x5d7ee1=Math['min'](_0x5d7ee1,_0x4a01ff);_0x484e08=Math[_0x4cb8('0x11')](_0x484e08,_0x5cdec1);_0x56672c=Math[_0x4cb8('0x40')](_0x56672c,_0x4a01ff);_0xe26a65=Math[_0x4cb8('0x40')](_0xe26a65,_0x5cdec1);}}}if(_0x5d7ee1>=_0x56672c||_0x484e08>=_0xe26a65){return _0x19c804;}const _0x2fe7ce=0x14;_0x5d7ee1=Math['max'](0x0,_0x5d7ee1-_0x2fe7ce);_0x484e08=Math[_0x4cb8('0x40')](0x0,_0x484e08-_0x2fe7ce);_0x56672c=Math['min'](_0x19c804[_0x4cb8('0x7c')]-0x1,_0x56672c+_0x2fe7ce);_0xe26a65=Math[_0x4cb8('0x11')](_0x19c804[_0x4cb8('0x9')]-0x1,_0xe26a65+_0x2fe7ce);const _0x108246=_0x56672c-_0x5d7ee1+0x1;const _0x57fdff=_0xe26a65-_0x484e08+0x1;const _0x1b4ed7=document[_0x4cb8('0x6d')]('canvas');_0x1b4ed7[_0x4cb8('0x7c')]=_0x108246;_0x1b4ed7['height']=_0x57fdff;const _0x5498cc=_0x1b4ed7[_0x4cb8('0x2')]('2d');_0x5498cc['drawImage'](_0x19c804,_0x5d7ee1,_0x484e08,_0x108246,_0x57fdff,0x0,0x0,_0x108246,_0x57fdff);return _0x1b4ed7;}function drawCloudText(_0xd0409a,_0x1cb228,_0x43f257){_0xd0409a['clearRect'](0x0,0x0,_0xd0409a[_0x4cb8('0x2e')]['width'],_0xd0409a['canvas']['height']);_0xd0409a['font']=_0x1cb228['fontWeight']+'\x20'+_0x1cb228['fontSize']*_0x43f257+'px\x20\x22'+_0x1cb228['font']+'\x22';_0xd0409a[_0x4cb8('0x7e')]='alphabetic';const _0x2c8aff=_0xd0409a[_0x4cb8('0x2e')][_0x4cb8('0x7c')]/0x2+offsetX*_0x43f257;const _0x279be5=_0xd0409a['canvas'][_0x4cb8('0x9')]/0x2+offsetY*_0x43f257;const _0x4f0965=_0xd0409a[_0x4cb8('0x25')]('M');const _0x4e32f6=_0x4f0965['actualBoundingBoxAscent']+_0x4f0965['actualBoundingBoxDescent'];const _0x3fc620=_0x279be5+_0x4e32f6/0x2-_0x4f0965[_0x4cb8('0x22')];const _0x3eb0a8=_0x1cb228['text'];const _0x42c4a4=_0x1cb228['letterSpacing']*_0x43f257;const _0x5dd4ce=_0xd0409a[_0x4cb8('0x25')](_0x3eb0a8)[_0x4cb8('0x7c')]+(_0x3eb0a8['length']-0x1)*_0x42c4a4;let _0x5f45bc=_0x2c8aff-_0x5dd4ce/0x2;_0xd0409a['lineJoin']=_0x4cb8('0x82');_0xd0409a['lineCap']=_0x4cb8('0x82');if(_0x1cb228[_0x4cb8('0x29')]>_0x1cb228['whiteSize']){_0xd0409a['strokeStyle']=_0x1cb228[_0x4cb8('0x8f')];_0xd0409a[_0x4cb8('0x3c')]=_0x1cb228[_0x4cb8('0x29')]*_0x43f257;_0xd0409a['globalCompositeOperation']='source-over';_0x5f45bc=_0x2c8aff-_0x5dd4ce/0x2;for(let _0x4df374=0x0;_0x4df374<_0x3eb0a8[_0x4cb8('0x15')];_0x4df374++){const _0x84a02d=_0x3eb0a8[_0x4df374];_0xd0409a[_0x4cb8('0x17')](_0x84a02d,_0x5f45bc,_0x3fc620);_0x5f45bc+=_0xd0409a['measureText'](_0x84a02d)['width']+_0x42c4a4;}}_0xd0409a[_0x4cb8('0x8e')]='destination-out';_0xd0409a['lineWidth']=_0x1cb228[_0x4cb8('0x49')]*_0x43f257;_0x5f45bc=_0x2c8aff-_0x5dd4ce/0x2;for(let _0x302c98=0x0;_0x302c98<_0x3eb0a8[_0x4cb8('0x15')];_0x302c98++){const _0x2f24d8=_0x3eb0a8[_0x302c98];_0xd0409a[_0x4cb8('0x17')](_0x2f24d8,_0x5f45bc,_0x3fc620);_0x5f45bc+=_0xd0409a[_0x4cb8('0x25')](_0x2f24d8)['width']+_0x42c4a4;}_0xd0409a[_0x4cb8('0x8e')]=_0x4cb8('0x28');_0xd0409a['strokeStyle']=_0x1cb228['innerColor'];_0xd0409a[_0x4cb8('0x3c')]=_0x1cb228['whiteSize']*_0x43f257;_0x5f45bc=_0x2c8aff-_0x5dd4ce/0x2;for(let _0x3994c4=0x0;_0x3994c4<_0x3eb0a8['length'];_0x3994c4++){const _0x2d7afe=_0x3eb0a8[_0x3994c4];_0xd0409a[_0x4cb8('0x17')](_0x2d7afe,_0x5f45bc,_0x3fc620);_0x5f45bc+=_0xd0409a[_0x4cb8('0x25')](_0x2d7afe)[_0x4cb8('0x7c')]+_0x42c4a4;}_0xd0409a['fillStyle']=_0x1cb228['textColor'];_0x5f45bc=_0x2c8aff-_0x5dd4ce/0x2;for(let _0x5f452a=0x0;_0x5f452a<_0x3eb0a8[_0x4cb8('0x15')];_0x5f452a++){const _0x713b2a=_0x3eb0a8[_0x5f452a];_0xd0409a['fillText'](_0x713b2a,_0x5f45bc,_0x3fc620);_0x5f45bc+=_0xd0409a[_0x4cb8('0x25')](_0x713b2a)['width']+_0x42c4a4;}}function getParams(){const _0x235af5=parseInt(document[_0x4cb8('0x84')]('whiteSize')['value']);const _0x3da298=parseInt(document[_0x4cb8('0x84')](_0x4cb8('0x29'))[_0x4cb8('0x4')]);return{'text':document['getElementById'](_0x4cb8('0x7d'))['value'],'font':document[_0x4cb8('0x84')](_0x4cb8('0xa'))['value'],'fontWeight':document[_0x4cb8('0x84')]('fontWeight')['value'],'outlineColor':document[_0x4cb8('0x84')](_0x4cb8('0x8f'))['value'],'innerColor':document['getElementById']('innerColor')[_0x4cb8('0x4')],'textColor':document['getElementById']('textColor')['value'],'outlineSize':_0x235af5+_0x3da298,'whiteSize':_0x235af5,'fontSize':parseInt(document['getElementById']('fontSize')['value']),'letterSpacing':parseInt(document['getElementById'](_0x4cb8('0x95'))[_0x4cb8('0x4')]),'exportScale':0x2};}function handleFontUpload(){const _0x1db6d9=document[_0x4cb8('0x84')]('fontFile');_0x1db6d9[_0x4cb8('0x1')](_0x4cb8('0x87'),function(_0x4324d5){const _0x239e33=_0x4324d5[_0x4cb8('0x68')]['files'][0x0];if(_0x239e33){const _0x210c2e=_0x239e33[_0x4cb8('0x3f')][_0x4cb8('0x99')]('.')[0x0];const _0x300f03=URL[_0x4cb8('0x7b')](_0x239e33);const _0x437885=new FontFace(_0x210c2e,'url('+_0x300f03+')');_0x437885[_0x4cb8('0x5c')]()['then'](function(_0x522e70){document[_0x4cb8('0x90')][_0x4cb8('0x94')](_0x522e70);const _0x195735=document[_0x4cb8('0x84')]('fontSelect');const _0x6cc0b9=document['createElement'](_0x4cb8('0xf'));_0x6cc0b9['value']=_0x210c2e;_0x6cc0b9['textContent']=_0x210c2e+_0x4cb8('0x34');_0x195735[_0x4cb8('0x51')](_0x6cc0b9);_0x195735['value']=_0x210c2e;generatePreview();})['catch'](function(_0x5104c2){alert(_0x4cb8('0x4a')+_0x5104c2[_0x4cb8('0x12')]);});}});}function createCanvas(_0x2908d3,_0x2c0371){const _0x13e3dd=document['createElement'](_0x4cb8('0x2e'));_0x13e3dd['width']=0x4b0*_0x2c0371;_0x13e3dd[_0x4cb8('0x9')]=0x1f4*_0x2c0371;const _0x61d80c=_0x13e3dd['getContext']('2d');drawCloudText(_0x61d80c,_0x2908d3,_0x2c0371);return _0x13e3dd;}function saveTextToStorage(_0x4f09f4){try{localStorage['setItem']('cloudText_content',_0x4f09f4);}catch(_0x22eada){console[_0x4cb8('0x86')](_0x4cb8('0x4f'),_0x22eada);}}function loadTextFromStorage(){try{const _0x42ea03=localStorage['getItem'](_0x4cb8('0xb'));if(_0x42ea03!==null){const _0x375a6f=document[_0x4cb8('0x84')](_0x4cb8('0x7d'));_0x375a6f[_0x4cb8('0x4')]=_0x42ea03;}}catch(_0x2fc8f6){console[_0x4cb8('0x86')](_0x4cb8('0x89'),_0x2fc8f6);}}function saveAllSettingsToStorage(){try{const _0x1de343={'fontSelect':document['getElementById']('fontSelect')['value'],'fontWeight':document[_0x4cb8('0x84')]('fontWeight')['value'],'fontSize':document['getElementById'](_0x4cb8('0x8'))['value'],'letterSpacing':document[_0x4cb8('0x84')]('letterSpacing')['value'],'whiteSize':document[_0x4cb8('0x84')](_0x4cb8('0x49'))['value'],'outlineSize':document[_0x4cb8('0x84')](_0x4cb8('0x29'))[_0x4cb8('0x4')],'textColor':document[_0x4cb8('0x84')](_0x4cb8('0x47'))[_0x4cb8('0x4')],'innerColor':document['getElementById']('innerColor')[_0x4cb8('0x4')],'outlineColor':document['getElementById']('outlineColor')[_0x4cb8('0x4')]};localStorage['setItem'](_0x4cb8('0x30'),JSON['stringify'](_0x1de343));}catch(_0x4de9ba){console['warn'](_0x4cb8('0xd'),_0x4de9ba);}}function loadAllSettingsFromStorage(){try{const _0x1a7fab=localStorage[_0x4cb8('0x5f')]('cloudText_settings');if(_0x1a7fab!==null){const _0x2ff2c1=JSON[_0x4cb8('0x7a')](_0x1a7fab);if(_0x2ff2c1[_0x4cb8('0xa')]){const _0x49a9d4=document[_0x4cb8('0x84')]('fontSelect');const _0x5e5f77=_0x49a9d4['querySelector']('option[value=\x22'+_0x2ff2c1['fontSelect']+'\x22]');if(_0x5e5f77){_0x49a9d4[_0x4cb8('0x4')]=_0x2ff2c1[_0x4cb8('0xa')];}}if(_0x2ff2c1[_0x4cb8('0x3')])document['getElementById']('fontWeight')[_0x4cb8('0x4')]=_0x2ff2c1[_0x4cb8('0x3')];if(_0x2ff2c1[_0x4cb8('0x8')])document['getElementById']('fontSize')[_0x4cb8('0x4')]=_0x2ff2c1['fontSize'];if(_0x2ff2c1['letterSpacing'])document['getElementById'](_0x4cb8('0x95'))['value']=_0x2ff2c1[_0x4cb8('0x95')];if(_0x2ff2c1[_0x4cb8('0x49')])document[_0x4cb8('0x84')](_0x4cb8('0x49'))['value']=_0x2ff2c1[_0x4cb8('0x49')];if(_0x2ff2c1['outlineSize'])document['getElementById'](_0x4cb8('0x29'))['value']=_0x2ff2c1[_0x4cb8('0x29')];if(_0x2ff2c1[_0x4cb8('0x47')])document['getElementById']('textColor')['value']=_0x2ff2c1['textColor'];if(_0x2ff2c1[_0x4cb8('0x92')])document['getElementById']('innerColor')[_0x4cb8('0x4')]=_0x2ff2c1[_0x4cb8('0x92')];if(_0x2ff2c1['outlineColor'])document[_0x4cb8('0x84')]('outlineColor')[_0x4cb8('0x4')]=_0x2ff2c1[_0x4cb8('0x8f')];updateRangeDisplays();}}catch(_0x231b0c){console['warn']('无法从本地存储读取设置:',_0x231b0c);}}function updateRangeDisplays(){const _0x4e356e=[{'id':'fontWeight','valueId':'fontWeightValue'},{'id':_0x4cb8('0x8'),'valueId':_0x4cb8('0xe')},{'id':_0x4cb8('0x95'),'valueId':'letterSpacingValue'},{'id':_0x4cb8('0x49'),'valueId':'whiteSizeValue'}];_0x4e356e['forEach'](_0x40029a=>{const _0x25ec3d=document['getElementById'](_0x40029a['id']);const _0x2ded78=document[_0x4cb8('0x84')](_0x40029a['valueId']);if(_0x25ec3d&&_0x2ded78){_0x2ded78['textContent']=_0x25ec3d[_0x4cb8('0x4')];}});const _0x1f336f=parseInt(document[_0x4cb8('0x84')]('whiteSize')[_0x4cb8('0x4')]);const _0xb48085=parseInt(document[_0x4cb8('0x84')]('outlineSize')['value']);const _0x3cfe40=document['getElementById'](_0x4cb8('0x3e'));if(_0x3cfe40){_0x3cfe40[_0x4cb8('0x24')]=_0x1f336f+_0xb48085;}}function initCanvasDrag(){previewCanvas['addEventListener']('mousedown',function(_0x166b5f){isDragging=!![];const _0x4463d2=previewCanvas[_0x4cb8('0x91')]();dragStartX=_0x166b5f['clientX']-_0x4463d2[_0x4cb8('0x7f')];dragStartY=_0x166b5f[_0x4cb8('0x66')]-_0x4463d2[_0x4cb8('0x43')];previewCanvas[_0x4cb8('0x32')][_0x4cb8('0x53')]=_0x4cb8('0x5e');});previewCanvas['addEventListener'](_0x4cb8('0x26'),function(_0x6982ae){if(!isDragging){previewCanvas['style'][_0x4cb8('0x53')]=_0x4cb8('0x5e');return;}const _0x40ed09=previewCanvas[_0x4cb8('0x91')]();const _0x56039e=_0x6982ae[_0x4cb8('0x80')]-_0x40ed09[_0x4cb8('0x7f')];const _0x5eaa94=_0x6982ae['clientY']-_0x40ed09[_0x4cb8('0x43')];offsetX+=_0x56039e-dragStartX;offsetY+=_0x5eaa94-dragStartY;dragStartX=_0x56039e;dragStartY=_0x5eaa94;requestAnimationFrame(()=>{generatePreview();});});previewCanvas[_0x4cb8('0x1')](_0x4cb8('0x98'),function(){isDragging=![];previewCanvas['style']['cursor']=_0x4cb8('0x5e');});previewCanvas[_0x4cb8('0x1')](_0x4cb8('0x39'),function(){isDragging=![];previewCanvas['style']['cursor']=_0x4cb8('0x5e');});previewCanvas[_0x4cb8('0x1')](_0x4cb8('0x8c'),function(_0x5c3bb9){_0x5c3bb9['preventDefault']();isDragging=!![];const _0x318790=_0x5c3bb9['touches'][0x0];const _0x1bcd09=previewCanvas[_0x4cb8('0x91')]();lastTouchX=_0x318790['clientX']-_0x1bcd09['left'];lastTouchY=_0x318790[_0x4cb8('0x66')]-_0x1bcd09[_0x4cb8('0x43')];});previewCanvas[_0x4cb8('0x1')](_0x4cb8('0x0'),function(_0x4a3ff9){_0x4a3ff9['preventDefault']();if(!isDragging)return;const _0x2d8cd5=_0x4a3ff9['touches'][0x0];const _0x547d34=previewCanvas[_0x4cb8('0x91')]();const _0x5314dd=_0x2d8cd5['clientX']-_0x547d34['left'];const _0x50234e=_0x2d8cd5[_0x4cb8('0x66')]-_0x547d34['top'];offsetX+=_0x5314dd-lastTouchX;offsetY+=_0x50234e-lastTouchY;lastTouchX=_0x5314dd;lastTouchY=_0x50234e;requestAnimationFrame(()=>{generatePreview();});});previewCanvas['addEventListener'](_0x4cb8('0x5'),function(_0x142cb8){_0x142cb8['preventDefault']();isDragging=![];});previewCanvas[_0x4cb8('0x1')](_0x4cb8('0x20'),function(){offsetX=0x0;offsetY=0x0;generatePreview();});previewCanvas['style']['cursor']='move';previewCanvas[_0x4cb8('0x32')]['userSelect']='none';}initControls();handleFontUpload();initCanvasDrag();generatePreview();
        </script>
    </body>
</html>
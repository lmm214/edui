<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <title>认读小能手</title>
    <style>
        body {
            font-family: "Microsoft YaHei", sans-serif;
            margin: 0;
            padding: 10px;
            background-color: #f0f9ff;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            box-sizing: border-box;
            overflow: hidden;
        }
        body.show-result {
            height: auto;
            overflow-y: auto;
        }
        .title {
            color: #FF4081;
            font-size: 36px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            margin:0 0 20px;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .start-container {
            text-align: center;
            padding: 20px;
            background-color: #fff;
            border-radius: 30px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
            margin: 20px;
            max-width: 800px;
            width: 90%;
        }

        .start-mascot {
            font-size: 80px;
            margin: 20px 0;
            animation: wave 2s infinite;
        }

        @keyframes wave {
            0%, 100% { transform: rotate(0); }
            25% { transform: rotate(-10deg); }
            75% { transform: rotate(10deg); }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .start-tip {
            font-size: 24px;
            color: #666;
            margin: 20px 0;
            line-height: 1.5;
        }

        .stats {
            background-color: #fff;
            padding: 10px 15px;
            border-radius: 15px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            width: 25%;
            min-width: 300px;
            max-width: 600px;
            font-size: 18px;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .stat-value {
            color: #FF5722;
            font-weight: bold;
        }

        .question-container {
            max-width: 1200px;
            width: 95%;
            background-color: #fff;
            padding-bottom: 20px;
            border-radius: 20px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
            text-align: center;
            margin: 0 auto;
        }

        .match-container {
            display: flex;
            flex-direction: column;
            gap: 80px;
            width: 100%;
            max-width: 1000px;
            margin: 0 auto;
            position: relative;
            padding: 20px 0;
        }

        .pinyin-row, .hanzi-row {
            display: flex;
            justify-content: space-between;
            padding: 0 20px;
            position: relative;
            z-index: 2;
        }

        .pinyin-item, .hanzi-item {
            position: relative;
            width: 120px;
            height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
            cursor: pointer;
            user-select: none;
            -webkit-user-select: none;
            font-size: 45px;
        }

        .hanzi-item {
            font-family: "Kaiti SC", STKaiti, "AR PL UKai CN", serif;
        }

        .connection-dot {
            width: 12px;
            height: 12px;
            background: #FF4081;
            border-radius: 50%;
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
        }

        .pinyin-item .connection-dot {
            bottom: -6px;
        }

        .hanzi-item .connection-dot {
            top: -6px;
        }

        .connection-line {
            position: absolute;
            background: #FF4081;
            height: 2px;
            transform-origin: 0 0;
            pointer-events: none;
            z-index: 1;
        }

        .temp-line {
            position: absolute;
            background: rgba(255, 64, 129, 0.3);
            height: 2px;
            transform-origin: 0 0;
            pointer-events: none;
            z-index: 2;
        }

        .selected {
            background: #E3F2FD;
            box-shadow: 0 0 0 2px #FF4081;
            z-index: 3;
        }

        .matched {
            background: #E3F2FD;
            pointer-events: none;
        }

        .matched .connection-dot {
            background: #4CAF50;
        }

        .lines-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .next-btn {
            font-size: 24px;
            padding: 15px 40px;
            border: none;
            border-radius: 20px;
            background:linear-gradient(145deg, #FF4081, #FF6E40);
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
        }

        .result-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
            gap: 20px;
            background-color: #fff;
            border-radius: 20px;
            margin: 0px auto;
            box-sizing: border-box;
        }

        .result-item {
            font-size: 28px;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            min-height: 50px;
        }

        .result-item.known {
            background-color: #C8E6C9;
            color: #2E7D32;
        }

        .result-item.unknown {
            background-color: #f5f5f5;
            color: #999;
        }

        .result-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            padding: 40px;
            border-radius: 30px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
            text-align: center;
            font-size: 28px;
            display: none;
        }

        .result-score {
            font-size: 48px;
            color: #FF5722;
            margin: 20px 0;
        }

        .emoji {
            font-size: 60px;
            margin: 10px 0;
        }

        .restart-btn {
            font-size: 36px;
            padding: 20px 60px;
            border: none;
            border-radius: 30px;
            background-color: #4CAF50;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 6px 12px rgba(0,0,0,0.2);
            margin-top: 20px;
        }

        .restart-btn:hover {
            background-color: #45a049;
            transform: translateY(-2px);
        }

        @media (max-width: 480px) {
            .hanzi-item {
                min-height: 60px;
            }
            .title {
                font-size: min(22px, 4vh);
                margin-bottom: 10px;
            }
            
            .stats {
                font-size: min(16px, 2.5vh);
                padding: 8px 12px;
                margin-bottom: 10px;
            }
            
            .hanzi {
                font-size: min(80px, 12vh);
                margin: 5px 0;
            }

            .options {
                gap: min(15px, 2vh);
                margin: 10px 0;
            }
            
            .option {
                font-size: min(28px, 4vh);
                padding: min(15px, 2vh);
                height: min(60px, 8vh);
            }

            @media (max-height: 600px) {
                .options {
                    grid-template-columns: 1fr 1fr;
                    gap: min(20px, 3vh);
                }
                
                .option {
                    font-size: min(36px, 5vh);
                    padding: min(20px, 3vh);
                    height: min(120px, 15vh);
                }
            }

            @media (min-height: 601px) {
                .options {
                    grid-template-columns: 1fr;
                    gap: min(15px, 2vh);
                }
                
                .option {
                    font-size: min(28px, 4vh);
                    padding: min(15px, 2vh);
                    height: min(60px, 8vh);
                }
            }
        }

        @media (min-width: 481px) {
            .options {
                grid-template-columns: 1fr 1fr;
                gap: min(20px, 3vh);
            }
            
            .option {
                font-size: min(42px, 5vh);
                padding: min(20px, 3vh);
                height: min(120px, 15vh);
            }
        }

        .start-btn {
            font-size: 36px;
            font-family: Baskerville, Georgia, "Liberation Serif", "Kaiti SC", STKaiti, "AR PL UKai CN", "AR PL UKai HK", "AR PL UKai TW", "AR PL UKai TW MBE", "AR PL KaitiM GB", KaiTi, KaiTi_GB2312, DFKai-SB, "TW\-Kai", serif;
            padding: 20px 60px;
            border: none;
            border-radius: 30px;
            box-shadow: 0 6px 12px rgba(0,0,0,0.2);
            margin: 30px 0 15px;
            background: linear-gradient(145deg, #FF4081, #FF6E40);
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            animation: pulse 2s infinite;
        }
        .start-btn:hover {
            transform: translateY(-2px);
        }

        .start-tip {
            font-size: 18px;
            color: #666;
            margin-bottom: 20px;
        }

        #resultContainer {
            width: 100%;
            max-width: 100%;
            padding: 20px;
            box-sizing: border-box;
        }

        .result-stats {
            width: 25%;
            min-width: 260px;
            max-width: 1200px;
            margin: 0 auto;
            background-color: #fff;
            padding: 15px 20px;
            border-radius: 15px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: min(16px, 2.5vh);
            color: #333;
        }

        .restart-stats-btn {
            width: 80px;
            font-size: 20px;
            padding: 8px 20px;
            border: none;
            border-radius: 10px;
            background-color: #4CAF50;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .restart-stats-btn:hover {
            background-color: #45a049;
            transform: translateY(-2px);
        }

        .result-section {
            margin: 20px 0;
        }

        .section-title {
            font-size: 24px;
            color: #333;
            margin: 20px 0;
            padding: 0 20px;
        }

        .result-item {
            position: relative;
            cursor: pointer;
        }

        .result-item .pinyin {
            position: absolute;
            top: -5px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 24px;
            color: #666;
            white-space: nowrap;
        }

        .result-item.unknown:hover {
            background-color: #E3F2FD;
        }

        .review-section {
            max-width: 1200px;
            margin: 20px auto;
            background-color: #fff;
            padding: 20px;
            border-radius: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .review-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(50px, 1fr));
            gap: 8px;
            margin-top: 15px;
        }

        @media (max-width: 480px) and (orientation: portrait) {
            .hanzi-group {
                margin: 0;
                grid-template-columns: repeat(3, 1fr);
                gap: 10px;
            }
            .next-btn{
                padding: 8px 25px;
                margin-top:10px;
                border-radius: 8px;
            }
            .result-grid {
                grid-template-columns: repeat(auto-fill, minmax(50px, 1fr));
                gap: 20px;
            }

            .result-item {
                font-size: 24px;
                min-height: 28px;
            }
            .result-item .pinyin{
                font-size: 22px;
            }
        }

        @media (max-width: 768px) {
            .question-container {
                width: 98%;
                padding: 10px 0;
            }

            .match-container {
                gap: 40px;
                padding: 10px 0;
            }

            .pinyin-item, .hanzi-item {
                width: 60px;
                height: 60px;
                font-size: 22px;
            }

            .hanzi-item {
                font-size: 24px;
            }

            .next-btn {
                font-size: 18px;
                padding: 10px 30px;
                margin-top: 15px;
            }
        }

        @media (max-width: 480px) {
            .question-container {
                width: 100%;
            }

            .match-container {
                gap: 30px;
            }

            .pinyin-item, .hanzi-item {
                width: 50px;
                height: 50px;
                font-size: 22px;
            }

            .hanzi-item {
                font-size: 20px;
            }

            .pinyin-row, .hanzi-row {
                padding: 0 10px;
            }

            .next-btn {
                font-size: 16px;
                padding: 8px 25px;
                margin-top: 10px;
            }
        }
    </style>
</head>
<body>
    <h1 class="title">认读小能手</h1>
    <div id="startContainer" class="start-container">
        <div class="start-mascot">🎯</div>
        <button id="startBtn" class="start-btn">开始挑战</button>
        <div class="start-tip">
            让我们来认读汉字吧！<br>
            点击认识的汉字<br>
            看看一分钟能认读多少个？
        </div>
    </div>

    <div class="stats">
        <div class="stat-item">
            <span>时间</span>
            <span id="timer" class="stat-value">60</span>
            <span>秒</span>
        </div>
        <div class="stat-item">
            <span>已认识</span>
            <span id="score" class="stat-value">0</span>
            <span>个</span>
        </div>
        <div class="stat-item">
            <span>第</span>
            <span id="groupCount" class="stat-value">1</span>
            <span>/28组</span>
        </div>
    </div>

    <div class="question-container">
        <div class="match-container">
            <div class="pinyin-row" id="pinyinRow"></div>
            <div class="hanzi-row" id="hanziRow"></div>
        </div>
        <button id="nextBtn" class="next-btn">下一组</button>
    </div>

    <div id="resultContainer" style="display: none;">
        <div class="result-stats">
            <div>共认读 <span id="finalKnown">0</span> 个</div>
            <button class="restart-stats-btn" onclick="resetTest()">重新开始</button>
        </div>

        <div class="review-section">
            <h3 class="section-title">再认一认</h3>
            <div id="reviewGrid" class="result-grid"></div>
        </div>
        
        <div class="review-section">
            <h3 class="section-title">测试结果</h3>
            <div id="resultGrid" class="result-grid"></div>
        </div>
    </div>

    <script>
        let characters = [
            { hanzi: '天', pinyin: 'tiān' },
            { hanzi: '地', pinyin: 'dì/de' },
            { hanzi: '人', pinyin: 'rén' },
            { hanzi: '你', pinyin: 'nǐ' },
            { hanzi: '我', pinyin: 'wǒ' },
            { hanzi: '他', pinyin: 'tā' },
            { hanzi: '一', pinyin: 'yī' },
            { hanzi: '二', pinyin: 'èr' },
            { hanzi: '三', pinyin: 'sān' },
            { hanzi: '四', pinyin: 'sì' },
            { hanzi: '五', pinyin: 'wǔ' },
            { hanzi: '上', pinyin: 'shàng' },
            { hanzi: '下', pinyin: 'xià' },
            { hanzi: '口', pinyin: 'kǒu' },
            { hanzi: '耳', pinyin: 'ěr' },
            { hanzi: '目', pinyin: 'mù' },
            { hanzi: '手', pinyin: 'shǒu' },
            { hanzi: '足', pinyin: 'zú' },
            { hanzi: '站', pinyin: 'zhàn' },
            { hanzi: '坐', pinyin: 'zuò' },
            { hanzi: '日', pinyin: 'rì' },
            { hanzi: '月', pinyin: 'yuè' },
            { hanzi: '山', pinyin: 'shān' },
            { hanzi: '川', pinyin: 'chuān' },
            { hanzi: '水', pinyin: 'shuǐ' },
            { hanzi: '火', pinyin: 'huǒ' },
            { hanzi: '田', pinyin: 'tián' },
            { hanzi: '禾', pinyin: 'hé' },
            { hanzi: '六', pinyin: 'liù' },
            { hanzi: '七', pinyin: 'qī' },
            { hanzi: '八', pinyin: 'bā' },
            { hanzi: '九', pinyin: 'jiǔ' },
            { hanzi: '十', pinyin: 'shí' },
            { hanzi: '爸', pinyin: 'bà' },
            { hanzi: '妈', pinyin: 'mā' },
            { hanzi: '大', pinyin: 'dà' },
            { hanzi: '马', pinyin: 'mǎ' },
            { hanzi: '路', pinyin: 'lù' },
            { hanzi: '土', pinyin: 'tǔ' },
            { hanzi: '本', pinyin: 'běn' },
            { hanzi: '学', pinyin: 'xué' },
            { hanzi: '校', pinyin: 'xiào' },
            { hanzi: '班', pinyin: 'bān' },
            { hanzi: '级', pinyin: 'jí' },
            { hanzi: '姓', pinyin: 'xìng' },
            { hanzi: '名', pinyin: 'míng' },
            { hanzi: '王', pinyin: 'wáng' },
            { hanzi: '哥', pinyin: 'gē' },
            { hanzi: '弟', pinyin: 'dì' },
            { hanzi: '画', pinyin: 'huà' },
            { hanzi: '花', pinyin: 'huā' },
            { hanzi: '桌', pinyin: 'zhuō' },
            { hanzi: '纸', pinyin: 'zhǐ' },
            { hanzi: '读', pinyin: 'dú' },
            { hanzi: '书', pinyin: 'shū' },
            { hanzi: '打', pinyin: 'dǎ' },
            { hanzi: '棋', pinyin: 'qí' },
            { hanzi: '积', pinyin: 'jī' },
            { hanzi: '木', pinyin: 'mù' },
            { hanzi: '鱼', pinyin: 'yú' },
            { hanzi: '鸭', pinyin: 'yā' },
            { hanzi: '乌', pinyin: 'wū' },
            { hanzi: '鸦', pinyin: 'yā' },
            { hanzi: '字', pinyin: 'zì' },
            { hanzi: '词', pinyin: 'cí' },
            { hanzi: '句', pinyin: 'jù' },
            { hanzi: '子', pinyin: 'zǐ' },
            { hanzi: '午', pinyin: 'wǔ' },
            { hanzi: '星', pinyin: 'xīng' },
            { hanzi: '期', pinyin: 'qī' },
            { hanzi: '语', pinyin: 'yǔ' },
            { hanzi: '文', pinyin: 'wén' },
            { hanzi: '写', pinyin: 'xiě' },
            { hanzi: '会', pinyin: 'huì' },
            { hanzi: '白', pinyin: 'bái' },
            { hanzi: '菜', pinyin: 'cài' },
            { hanzi: '西', pinyin: 'xī' },
            { hanzi: '瓜', pinyin: 'guā' },
            { hanzi: '果', pinyin: 'guǒ' },
            { hanzi: '蓝', pinyin: 'lán' },
            { hanzi: '云', pinyin: 'yún' },
            { hanzi: '草', pinyin: 'cǎo' },
            { hanzi: '原', pinyin: 'yuán' },
            { hanzi: '小', pinyin: 'xiǎo' },
            { hanzi: '桥', pinyin: 'qiáo' },
            { hanzi: '流', pinyin: 'liú' },
            { hanzi: '柳', pinyin: 'liǔ' },
            { hanzi: '冰', pinyin: 'bīng' },
            { hanzi: '自', pinyin: 'zì' },
            { hanzi: '行', pinyin: 'xíng' },
            { hanzi: '车', pinyin: 'chē' },
            { hanzi: '开', pinyin: 'kāi' },
            { hanzi: '雪', pinyin: 'xuě' },
            { hanzi: '夜', pinyin: 'yè' },
            { hanzi: '色', pinyin: 'sè' },
            { hanzi: '美', pinyin: 'měi' },
            { hanzi: '晚', pinyin: 'wǎn' },
            { hanzi: '昨', pinyin: 'zuó' },
            { hanzi: '今', pinyin: 'jīn' },
            { hanzi: '明', pinyin: 'míng' },
            { hanzi: '个', pinyin: 'gè' },
            { hanzi: '这', pinyin: 'zhè' },
            { hanzi: '去', pinyin: 'qù' },
            { hanzi: '年', pinyin: 'nián' },
            { hanzi: '秋', pinyin: 'qiū' },
            { hanzi: '气', pinyin: 'qì' },
            { hanzi: '了', pinyin: 'le' },
            { hanzi: '树', pinyin: 'shù' },
            { hanzi: '叶', pinyin: 'yè' },
            { hanzi: '黄', pinyin: 'huáng' },
            { hanzi: '片', pinyin: 'piàn' },
            { hanzi: '从', pinyin: 'cóng' },
            { hanzi: '来', pinyin: 'lái' },
            { hanzi: '飞', pinyin: 'fēi' },
            { hanzi: '江', pinyin: 'jiāng' },
            { hanzi: '南', pinyin: 'nán' },
            { hanzi: '可', pinyin: 'kě' },
            { hanzi: '菜', pinyin: 'cài' },
            { hanzi: '莲', pinyin: 'lián' },
            { hanzi: '戏', pinyin: 'xì' },
            { hanzi: '间', pinyin: 'jiān' },
            { hanzi: '东', pinyin: 'dōng' },
            { hanzi: '北', pinyin: 'běi' },
            { hanzi: '的', pinyin: 'de' },
            { hanzi: '家', pinyin: 'jiā' },
            { hanzi: '鸡', pinyin: 'jī' },
            { hanzi: '竹', pinyin: 'zhú' },
            { hanzi: '牙', pinyin: 'yá' },
            { hanzi: '用', pinyin: 'yòng' },
            { hanzi: '几', pinyin: 'jǐ' },
            { hanzi: '步', pinyin: 'bù' },
            { hanzi: '没', pinyin: 'méi' },
            { hanzi: '参', pinyin: 'cān' },
            { hanzi: '加', pinyin: 'jiā' },
            { hanzi: '鸟', pinyin: 'niǎo' },
            { hanzi: '说', pinyin: 'shuō' },
            { hanzi: '是', pinyin: 'shì' },
            { hanzi: '春', pinyin: 'chūn' },
            { hanzi: '青', pinyin: 'qīng' },
            { hanzi: '蛙', pinyin: 'wā' },
            { hanzi: '夏', pinyin: 'xià' },
            { hanzi: '皮', pinyin: 'pí' },
            { hanzi: '就', pinyin: 'jiù' },
            { hanzi: '冬', pinyin: 'dōng' },
            { hanzi: '男', pinyin: 'nán' },
            { hanzi: '女', pinyin: 'nǚ' },
            { hanzi: '关', pinyin: 'guān' },
            { hanzi: '正', pinyin: 'zhèng' },
            { hanzi: '反', pinyin: 'fǎn' },
            { hanzi: '先', pinyin: 'xiān' },
            { hanzi: '后', pinyin: 'hòu' },
            { hanzi: '内', pinyin: 'nèi' },
            { hanzi: '外', pinyin: 'wài' },
            { hanzi: '对', pinyin: 'duì' },
            { hanzi: '歌', pinyin: 'gē' },
            { hanzi: '雨', pinyin: 'yǔ' },
            { hanzi: '风', pinyin: 'fēng' },
            { hanzi: '虫', pinyin: 'chóng' },
            { hanzi: '清', pinyin: 'qīng' },
            { hanzi: '绿', pinyin: 'lǜ' },
            { hanzi: '桃', pinyin: 'táo' },
            { hanzi: '红', pinyin: 'hóng' },
            { hanzi: '力', pinyin: 'lì' },
            { hanzi: '尖', pinyin: 'jiān' },
            { hanzi: '尘', pinyin: 'chén' },
            { hanzi: '众', pinyin: 'zhòng' },
            { hanzi: '双', pinyin: 'shuāng' },
            { hanzi: '林', pinyin: 'lín' },
            { hanzi: '森', pinyin: 'sēn' },
            { hanzi: '不', pinyin: 'bù' },
            { hanzi: '条', pinyin: 'tiáo' },
            { hanzi: '心', pinyin: 'xīn' },
            { hanzi: '金', pinyin: 'jīn' },
            { hanzi: '包', pinyin: 'bāo' },
            { hanzi: '尺', pinyin: 'chǐ' },
            { hanzi: '作', pinyin: 'zuò' },
            { hanzi: '业', pinyin: 'yè' },
            { hanzi: '笔', pinyin: 'bǐ' },
            { hanzi: '刀', pinyin: 'dāo' },
            { hanzi: '宝', pinyin: 'bǎo' },
            { hanzi: '贝', pinyin: 'bèi' },
            { hanzi: '少', pinyin: 'shǎo' },
            { hanzi: '课', pinyin: 'kè' },
            { hanzi: '早', pinyin: 'zǎo' },
            { hanzi: '升', pinyin: 'shēng' },
            { hanzi: '国', pinyin: 'guó' },
            { hanzi: '旗', pinyin: 'qí' },
            { hanzi: '中', pinyin: 'zhōng' },
            { hanzi: '们', pinyin: 'men' },
            { hanzi: '声', pinyin: 'shēng' },
            { hanzi: '起', pinyin: 'qǐ' },
            { hanzi: '多', pinyin: 'duō' },
            { hanzi: '么', pinyin: 'me' },
            { hanzi: '向', pinyin: 'xiàng' },
            { hanzi: '立', pinyin: 'lì' },
            { hanzi: '老', pinyin: 'lǎo' },
            { hanzi: '师', pinyin: 'shī' },
            { hanzi: '工', pinyin: 'gōng' },
            { hanzi: '厂', pinyin: 'chǎng' },
            { hanzi: '医', pinyin: 'yī' },
            { hanzi: '院', pinyin: 'yuàn' },
            { hanzi: '生', pinyin: 'shēng' },
            { hanzi: '门', pinyin: 'mén' },
            { hanzi: '卫', pinyin: 'wèi' },
            { hanzi: '船', pinyin: 'chuán' },
            { hanzi: '弯', pinyin: 'wān' },
            { hanzi: '儿', pinyin: 'ér' },
            { hanzi: '两', pinyin: 'liǎng' },
            { hanzi: '头', pinyin: 'tóu' },
            { hanzi: '在', pinyin: 'zài' },
            { hanzi: '里', pinyin: 'lǐ' },
            { hanzi: '看', pinyin: 'kàn' },
            { hanzi: '见', pinyin: 'jiàn' },
            { hanzi: '闪', pinyin: 'shǎn' },
            { hanzi: '影', pinyin: 'yǐng' },
            { hanzi: '前', pinyin: 'qián' },
            { hanzi: '常', pinyin: 'cháng' },
            { hanzi: '黑', pinyin: 'hēi' },
            { hanzi: '狗', pinyin: 'gǒu' },
            { hanzi: '左', pinyin: 'zuǒ' },
            { hanzi: '右', pinyin: 'yòu' },
            { hanzi: '它', pinyin: 'tā' },
            { hanzi: '好', pinyin: 'hǎo' },
            { hanzi: '朋', pinyin: 'péng' },
            { hanzi: '友', pinyin: 'yǒu' },
            { hanzi: '件', pinyin: 'jiàn' },
            { hanzi: '有', pinyin: 'yǒu' },
            { hanzi: '和', pinyin: 'hé' },
            { hanzi: '做', pinyin: 'zuò' },
            { hanzi: '也', pinyin: 'yě' },
            { hanzi: '办', pinyin: 'bàn' },
            { hanzi: '到', pinyin: 'dào' },
            { hanzi: '又', pinyin: 'yòu' },
            { hanzi: '才', pinyin: 'cái' },
            { hanzi: '能', pinyin: 'néng' },
            { hanzi: '爷', pinyin: 'yé' },
            { hanzi: '奶', pinyin: 'nǎi' },
            { hanzi: '叔', pinyin: 'shū' },
            { hanzi: '姐', pinyin: 'jiě' },
            { hanzi: '妹', pinyin: 'mèi' },
            { hanzi: '比', pinyin: 'bǐ' },
            { hanzi: '尾', pinyin: 'wěi' },
            { hanzi: '巴', pinyin: 'bā' },
            { hanzi: '谁', pinyin: 'shuí' },
            { hanzi: '短', pinyin: 'duǎn' },
            { hanzi: '把', pinyin: 'bǎ' },
            { hanzi: '伞', pinyin: 'sǎn' },
            { hanzi: '兔', pinyin: 'tù' },
            { hanzi: '最', pinyin: 'zuì' },
            { hanzi: '公', pinyin: 'gōng' },
            { hanzi: '喝', pinyin: 'hē' },
            { hanzi: '只', pinyin: 'zhī' },
            { hanzi: '处', pinyin: 'chù' },
            { hanzi: '找', pinyin: 'zhǎo' },
            { hanzi: '着', pinyin: 'zhe/zháo' },
            { hanzi: '许', pinyin: 'xǔ' },
            { hanzi: '石', pinyin: 'shí' },
            { hanzi: '出', pinyin: 'chū' },
            { hanzi: '法', pinyin: 'fǎ' },
            { hanzi: '放', pinyin: 'fàng' },
            { hanzi: '进', pinyin: 'jìn' },
            { hanzi: '高', pinyin: 'gāo' },
            { hanzi: '点', pinyin: 'diǎn' },
            { hanzi: '数', pinyin: 'shù/shǔ' },
            { hanzi: '彩', pinyin: 'cǎi' },
            { hanzi: '半', pinyin: 'bàn' },
            { hanzi: '空', pinyin: 'kōng' },
            { hanzi: '问', pinyin: 'wèn' },
            { hanzi: '回', pinyin: 'huí' },
            { hanzi: '答', pinyin: 'dá' },
            { hanzi: '方', pinyin: 'fāng' },
            { hanzi: '久', pinyin: 'jiǔ' },
            { hanzi: '更', pinyin: 'gèng' },
            { hanzi: '长', pinyin: 'zhǎng/cháng' },
            { hanzi: '牛', pinyin: 'niú' },
            { hanzi: '羊', pinyin: 'yáng' },
            { hanzi: '爪', pinyin: 'zhuǎ' },
            { hanzi: '旦', pinyin: 'dàn' },
            { hanzi: '拼', pinyin: 'pīn' },
            { hanzi: '音', pinyin: 'yīn' }
        ];

        let currentGroup = 0;
        let knownCharacters = new Set();
        let timeLeft = 60;
        let timerInterval;
        let isTestStarted = false;
        let skippedCharacters = new Set();
        let currentCharacters = [];
        let selectedPinyin = null;
        let selectedHanzi = null;
        let matchedPairs = new Set();
        let tempLine = null;
        let isDrawing = false;

        // 初始状态设置
        document.querySelector('.stats').style.display = 'none';
        document.querySelector('.question-container').style.display = 'none';
        document.getElementById('resultContainer').style.display = 'none';

        function startTest() {
            if (isTestStarted) return;
            
            // 创建新数组存储打乱后的字符
            currentCharacters = shuffleArray([...characters]);
            
            isTestStarted = true;
            currentGroup = 0;
            knownCharacters.clear();
            skippedCharacters.clear();
            timeLeft = 60;
            
            // 隐藏开始按钮，显示测试界面
            document.getElementById('startContainer').style.display = 'none';
            document.querySelector('.stats').style.display = 'flex';
            document.querySelector('.question-container').style.display = 'block';
            
            // 重置显示
            document.getElementById('score').textContent = '0';
            document.getElementById('groupCount').textContent = '1';
            document.getElementById('timer').textContent = '60';
            
            startTimer();
            showGroup();
        }

        function startTimer() {
            document.getElementById('timer').textContent = timeLeft;
            timerInterval = setInterval(() => {
                timeLeft--;
                document.getElementById('timer').textContent = timeLeft;
                if (timeLeft <= 0) {
                    endTest();
                }
            }, 1000);
        }

        function showGroup() {
            const startIndex = currentGroup * 5;
            const groupCharacters = currentCharacters.slice(startIndex, startIndex + 5);
            const pinyinRow = document.getElementById('pinyinRow');
            const hanziRow = document.getElementById('hanziRow');
            
            pinyinRow.innerHTML = '';
            hanziRow.innerHTML = '';
            matchedPairs.clear();
            
            // 清除所有连线
            const container = document.querySelector('.match-container');
            const linesContainer = container.querySelector('.lines-container');
            if (linesContainer) {
                linesContainer.remove();
            }
            
            // 创建新的连线容器
            const newLinesContainer = document.createElement('div');
            newLinesContainer.className = 'lines-container';
            container.appendChild(newLinesContainer);
            
            if (tempLine) {
                tempLine.remove();
                tempLine = null;
            }

            // 打乱拼音顺序
            const shuffledPinyin = shuffleArray([...groupCharacters]);

            // 创建拼音元素
            shuffledPinyin.forEach((char, index) => {
                const div = document.createElement('div');
                div.className = 'pinyin-item';
                div.textContent = char.pinyin;
                div.dataset.index = index;
                div.dataset.pinyin = char.pinyin;
                
                const dot = document.createElement('div');
                dot.className = 'connection-dot';
                div.appendChild(dot);
                
                div.onclick = () => selectPinyin(div);
                pinyinRow.appendChild(div);
            });

            // 创建汉字元素
            groupCharacters.forEach((char, index) => {
                const div = document.createElement('div');
                div.className = 'hanzi-item';
                div.textContent = char.hanzi;
                div.dataset.index = index;
                div.dataset.hanzi = char.hanzi;
                div.dataset.pinyin = char.pinyin;
                
                const dot = document.createElement('div');
                dot.className = 'connection-dot';
                div.appendChild(dot);
                
                div.onclick = () => selectHanzi(div);
                hanziRow.appendChild(div);
            });

            document.getElementById('groupCount').textContent = currentGroup + 1;
        }

        function selectPinyin(element) {
            if (element.classList.contains('matched')) return;
            
            if (selectedPinyin) {
                selectedPinyin.classList.remove('selected');
            }
            selectedPinyin = element;
            element.classList.add('selected');
            
            // 开始绘制临时连线
            isDrawing = true;
            createTempLine(element);
            
            // 如果已经选中了汉字，尝试匹配
            if (selectedHanzi) {
                checkMatch();
            }
        }

        function selectHanzi(element) {
            if (element.classList.contains('matched')) return;
            
            if (selectedHanzi) {
                selectedHanzi.classList.remove('selected');
            }
            selectedHanzi = element;
            element.classList.add('selected');
            
            // 开始绘制临时连线
            isDrawing = true;
            createTempLine(element);
            
            // 如果已经选中了拼音，尝试匹配
            if (selectedPinyin) {
                checkMatch();
            }
        }

        function createTempLine(element) {
            const container = document.querySelector('.match-container');
            
            if (!tempLine) {
                tempLine = document.createElement('div');
                tempLine.className = 'temp-line';
                container.appendChild(tempLine);
            }
            
            const dot = element.querySelector('.connection-dot');
            const rect = dot.getBoundingClientRect();
            const containerRect = container.getBoundingClientRect();
            
            const x1 = rect.left - containerRect.left + rect.width / 2;
            const y1 = rect.top - containerRect.top + (element.classList.contains('pinyin-item') ? rect.height : 0);
            
            tempLine.style.left = `${x1}px`;
            tempLine.style.top = `${y1}px`;
            
            // 添加鼠标移动事件监听
            container.onmousemove = updateTempLine;
        }
        
        function updateTempLine(e) {
            if (!isDrawing || !tempLine) return;
            
            const container = document.querySelector('.match-container');
            const containerRect = container.getBoundingClientRect();
            const x1 = parseInt(tempLine.style.left);
            const y1 = parseInt(tempLine.style.top);
            const x2 = e.clientX - containerRect.left;
            const y2 = e.clientY - containerRect.top;
            
            const length = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));
            const angle = Math.atan2(y2 - y1, x2 - x1) * 180 / Math.PI;
            
            tempLine.style.width = `${length}px`;
            tempLine.style.transform = `rotate(${angle}deg)`;
        }

        function checkMatch() {
            if (!selectedPinyin || !selectedHanzi) return;
            
            // 清除临时连线
            if (tempLine) {
                tempLine.remove();
                tempLine = null;
            }
            isDrawing = false;
            
            if (selectedHanzi.dataset.pinyin === selectedPinyin.dataset.pinyin) {
                // 匹配成功
                createConnection(selectedPinyin, selectedHanzi);
                selectedPinyin.classList.add('matched');
                selectedHanzi.classList.add('matched');
                matchedPairs.add(selectedHanzi.dataset.hanzi);
                
                if (matchedPairs.size === 5) {
                    setTimeout(showNextGroup, 500);
                }
            }
            
            selectedPinyin.classList.remove('selected');
            selectedHanzi.classList.remove('selected');
            selectedPinyin = null;
            selectedHanzi = null;
            
            // 移除鼠标移动事件监听
            document.querySelector('.match-container').onmousemove = null;
        }

        function createConnection(pinyinElement, hanziElement) {
            const line = document.createElement('div');
            line.className = 'connection-line';
            
            const linesContainer = document.querySelector('.lines-container');
            const pinyinDot = pinyinElement.querySelector('.connection-dot');
            const hanziDot = hanziElement.querySelector('.connection-dot');
            
            const pinyinRect = pinyinDot.getBoundingClientRect();
            const hanziRect = hanziDot.getBoundingClientRect();
            
            const container = document.querySelector('.match-container');
            const containerRect = container.getBoundingClientRect();
            
            const x1 = pinyinRect.left - containerRect.left + pinyinRect.width / 2;
            const y1 = pinyinRect.top - containerRect.top + pinyinRect.height;
            const x2 = hanziRect.left - containerRect.left + hanziRect.width / 2;
            const y2 = hanziRect.top - containerRect.top;
            
            const length = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));
            const angle = Math.atan2(y2 - y1, x2 - x1) * 180 / Math.PI;
            
            line.style.width = `${length}px`;
            line.style.left = `${x1}px`;
            line.style.top = `${y1}px`;
            line.style.transform = `rotate(${angle}deg)`;
            
            linesContainer.appendChild(line);
        }

        function showNextGroup() {
            if (currentGroup < 27) {
                // 记录跳过的字
                const currentGroupElements = document.querySelectorAll('.hanzi-item');
                currentGroupElements.forEach(el => {
                    if (!el.classList.contains('known')) {
                        skippedCharacters.add(el.textContent);
                    }
                });
                
                currentGroup++;
                showGroup();
            } else {
                endTest();
            }
        }

        function showResults() {
            document.body.classList.add('show-result');

            const resultContainer = document.getElementById('resultGrid');
            const reviewContainer = document.getElementById('reviewGrid');
            resultContainer.innerHTML = '';
            reviewContainer.innerHTML = '';
            
            // 只显示未认识的字(不包括最后一组未点击的)
            const lastGroupStartIndex = currentGroup * 10;
            currentCharacters.forEach((char, index) => {
                if (!knownCharacters.has(char.hanzi) && index < lastGroupStartIndex) {
                    const div = document.createElement('div');
                    div.className = 'result-item unknown';
                    div.textContent = char.hanzi;
                    div.onclick = () => {
                        if (!div.querySelector('.pinyin')) {
                            const pinyin = document.createElement('div');
                            pinyin.className = 'pinyin';
                            pinyin.textContent = char.pinyin;
                            div.appendChild(pinyin);
                        }
                    };
                    reviewContainer.appendChild(div);
                }
            });

            // 显示所有字的结果
            currentCharacters.forEach(char => {
                const div = document.createElement('div');
                div.className = 'result-item';
                div.textContent = char.hanzi;
                
                if (knownCharacters.has(char.hanzi)) {
                    div.classList.add('known');
                    const pinyin = document.createElement('div');
                    pinyin.className = 'pinyin';
                    pinyin.textContent = char.pinyin;
                    div.appendChild(pinyin);
                } else {
                    div.classList.add('unknown');
                    div.onclick = () => {
                        if (!div.querySelector('.pinyin')) {
                            const pinyin = document.createElement('div');
                            pinyin.className = 'pinyin';
                            pinyin.textContent = char.pinyin;
                            div.appendChild(pinyin);
                        }
                    };
                }
                resultContainer.appendChild(div);
            });

            document.getElementById('finalKnown').textContent = knownCharacters.size;
            document.getElementById('resultContainer').style.display = 'block';
        }

        function endTest() {
            clearInterval(timerInterval);
            isTestStarted = false;
            
            document.querySelector('.question-container').style.display = 'none';
            document.querySelector('.stats').style.display = 'none';
            showResults();
        }

        function resetTest() {
            clearInterval(timerInterval);
            isTestStarted = false;
            currentGroup = 0;
            knownCharacters.clear();
            skippedCharacters.clear();
            timeLeft = 60;
            currentCharacters = [];
            
            document.body.classList.remove('show-result');
            
            // 重置界面
            document.getElementById('resultContainer').style.display = 'none';
            document.getElementById('startContainer').style.display = 'block';
            document.querySelector('.stats').style.display = 'none';
            document.querySelector('.question-container').style.display = 'none';
            
            // 重置显示
            document.getElementById('score').textContent = '0';
            document.getElementById('groupCount').textContent = '1';
            document.getElementById('timer').textContent = '60';
        }

        // 添加重新开始按钮的事件监听
        document.getElementById('startBtn').onclick = startTest;

        // 添加下一组按钮的事件监听
        document.getElementById('nextBtn').onclick = showNextGroup;

        // 优化 Fisher-Yates 洗牌算法
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }
    </script>
</body>
</html>
